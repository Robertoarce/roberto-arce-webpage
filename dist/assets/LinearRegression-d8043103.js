var ce=Object.defineProperty;var ge=(n,s,e)=>s in n?ce(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e;var _t=(n,s,e)=>(ge(n,typeof s!="symbol"?s+"":s,e),e),kt=(n,s,e)=>{if(!s.has(n))throw TypeError("Cannot "+e)};var Z=(n,s,e)=>(kt(n,s,"read from private field"),e?e.call(n):s.get(n)),Rt=(n,s,e)=>{if(s.has(n))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(n):s.set(n,e)},mt=(n,s,e,t)=>(kt(n,s,"write to private field"),t?t.call(n,e):s.set(n,e),e);var Tt=(n,s,e)=>(kt(n,s,"access private method"),e);import{_ as me,g as tt,h as we,i as $t,j as pe,k as de,o as rt,c as ot,b as P,w as wt,l as ye,n as Bt,e as be,v as Dt,F as It,r as Ft,m as ve}from"./index-760141e9.js";import{P as Se}from"./plotly.min-ebae881e.js";import{g as Qt}from"./_commonjsHelpers-23102255.js";var N={};const Me=Object.prototype.toString;function it(n){const s=Me.call(n);return s.endsWith("Array]")&&!s.includes("Big")}const Ee=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:it},Symbol.toStringTag,{value:"Module"})),je=Qt(Ee);function ke(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!it(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var e=s.fromIndex,t=e===void 0?0:e,r=s.toIndex,o=r===void 0?n.length:r;if(t<0||t>=n.length||!Number.isInteger(t))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=t||o>n.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=n[t],l=t+1;l<o;l++)n[l]>i&&(i=n[l]);return i}function Re(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!it(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var e=s.fromIndex,t=e===void 0?0:e,r=s.toIndex,o=r===void 0?n.length:r;if(t<0||t>=n.length||!Number.isInteger(t))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=t||o>n.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=n[t],l=t+1;l<o;l++)n[l]<i&&(i=n[l]);return i}function Te(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(it(n)){if(n.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(s.output!==void 0){if(!it(s.output))throw new TypeError("output option must be an array if specified");e=s.output}else e=new Array(n.length);var t=Re(n),r=ke(n);if(t===r)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=s.min,i=o===void 0?s.autoMinMax?t:0:o,l=s.max,u=l===void 0?s.autoMinMax?r:1:l;if(i>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-i)/(r-t),g=0;g<n.length;g++)e[g]=(n[g]-t)*h+i;return e}const De=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"})),Ie=Qt(De);Object.defineProperty(N,"__esModule",{value:!0});var G=je,Ot=Ie;const pt=" ".repeat(2),Jt=" ".repeat(4);function Fe(){return Xt(this)}function Xt(n,s={}){const{maxRows:e=15,maxColumns:t=10,maxNumSize:r=8,padMinus:o="auto"}=s;return`${n.constructor.name} {
${pt}[
${Jt}${Ce(n,e,t,r,o)}
${pt}]
${pt}rows: ${n.rows}
${pt}columns: ${n.columns}
}`}function Ce(n,s,e,t,r){const{rows:o,columns:i}=n,l=Math.min(o,s),u=Math.min(i,e),h=[];if(r==="auto"){r=!1;t:for(let g=0;g<l;g++)for(let a=0;a<u;a++)if(n.get(g,a)<0){r=!0;break t}}for(let g=0;g<l;g++){let a=[];for(let w=0;w<u;w++)a.push(Ne(n.get(g,w),t,r));h.push(`${a.join(" ")}`)}return u!==i&&(h[h.length-1]+=` ... ${i-e} more columns`),l!==o&&h.push(`... ${o-s} more rows`),h.join(`
${Jt}`)}function Ne(n,s,e){return(n>=0&&e?` ${Gt(n,s-1)}`:Gt(n,s)).padEnd(s)}function Gt(n,s){let e=n.toString();if(e.length<=s)return e;let t=n.toFixed(s);if(t.length>s&&(t=n.toFixed(Math.max(0,s-(t.length-s)))),t.length<=s&&!t.startsWith("0.000")&&!t.startsWith("-0.000"))return t;let r=n.toExponential(s);return r.length>s&&(r=n.toExponential(Math.max(0,s-(r.length-s)))),r.slice(0)}function qe(n,s){n.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},n.prototype.addS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+t);return this},n.prototype.addM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+t.get(r,o));return this},n.add=function(t,r){return new s(t).add(r)},n.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},n.prototype.subS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-t);return this},n.prototype.subM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-t.get(r,o));return this},n.sub=function(t,r){return new s(t).sub(r)},n.prototype.subtract=n.prototype.sub,n.prototype.subtractS=n.prototype.subS,n.prototype.subtractM=n.prototype.subM,n.subtract=n.sub,n.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},n.prototype.mulS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*t);return this},n.prototype.mulM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*t.get(r,o));return this},n.mul=function(t,r){return new s(t).mul(r)},n.prototype.multiply=n.prototype.mul,n.prototype.multiplyS=n.prototype.mulS,n.prototype.multiplyM=n.prototype.mulM,n.multiply=n.mul,n.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},n.prototype.divS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/t);return this},n.prototype.divM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/t.get(r,o));return this},n.div=function(t,r){return new s(t).div(r)},n.prototype.divide=n.prototype.div,n.prototype.divideS=n.prototype.divS,n.prototype.divideM=n.prototype.divM,n.divide=n.div,n.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},n.prototype.modS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%t);return this},n.prototype.modM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%t.get(r,o));return this},n.mod=function(t,r){return new s(t).mod(r)},n.prototype.modulus=n.prototype.mod,n.prototype.modulusS=n.prototype.modS,n.prototype.modulusM=n.prototype.modM,n.modulus=n.mod,n.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},n.prototype.andS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&t);return this},n.prototype.andM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&t.get(r,o));return this},n.and=function(t,r){return new s(t).and(r)},n.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},n.prototype.orS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|t);return this},n.prototype.orM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|t.get(r,o));return this},n.or=function(t,r){return new s(t).or(r)},n.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},n.prototype.xorS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^t);return this},n.prototype.xorM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^t.get(r,o));return this},n.xor=function(t,r){return new s(t).xor(r)},n.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},n.prototype.leftShiftS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<t);return this},n.prototype.leftShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<t.get(r,o));return this},n.leftShift=function(t,r){return new s(t).leftShift(r)},n.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},n.prototype.signPropagatingRightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>t);return this},n.prototype.signPropagatingRightShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>t.get(r,o));return this},n.signPropagatingRightShift=function(t,r){return new s(t).signPropagatingRightShift(r)},n.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},n.prototype.rightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>t);return this},n.prototype.rightShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>t.get(r,o));return this},n.rightShift=function(t,r){return new s(t).rightShift(r)},n.prototype.zeroFillRightShift=n.prototype.rightShift,n.prototype.zeroFillRightShiftS=n.prototype.rightShiftS,n.prototype.zeroFillRightShiftM=n.prototype.rightShiftM,n.zeroFillRightShift=n.rightShift,n.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},n.not=function(t){return new s(t).not()},n.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},n.abs=function(t){return new s(t).abs()},n.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},n.acos=function(t){return new s(t).acos()},n.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},n.acosh=function(t){return new s(t).acosh()},n.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},n.asin=function(t){return new s(t).asin()},n.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},n.asinh=function(t){return new s(t).asinh()},n.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},n.atan=function(t){return new s(t).atan()},n.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},n.atanh=function(t){return new s(t).atanh()},n.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},n.cbrt=function(t){return new s(t).cbrt()},n.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},n.ceil=function(t){return new s(t).ceil()},n.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},n.clz32=function(t){return new s(t).clz32()},n.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},n.cos=function(t){return new s(t).cos()},n.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},n.cosh=function(t){return new s(t).cosh()},n.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},n.exp=function(t){return new s(t).exp()},n.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},n.expm1=function(t){return new s(t).expm1()},n.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},n.floor=function(t){return new s(t).floor()},n.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},n.fround=function(t){return new s(t).fround()},n.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},n.log=function(t){return new s(t).log()},n.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},n.log1p=function(t){return new s(t).log1p()},n.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},n.log10=function(t){return new s(t).log10()},n.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},n.log2=function(t){return new s(t).log2()},n.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},n.round=function(t){return new s(t).round()},n.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},n.sign=function(t){return new s(t).sign()},n.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},n.sin=function(t){return new s(t).sin()},n.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},n.sinh=function(t){return new s(t).sinh()},n.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},n.sqrt=function(t){return new s(t).sqrt()},n.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},n.tan=function(t){return new s(t).tan()},n.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},n.tanh=function(t){return new s(t).tanh()},n.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},n.trunc=function(t){return new s(t).trunc()},n.pow=function(t,r){return new s(t).pow(r)},n.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},n.prototype.powS=function(t){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)**t);return this},n.prototype.powM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)**t.get(r,o));return this}}function J(n,s,e){let t=e?n.rows:n.rows-1;if(s<0||s>t)throw new RangeError("Row index out of range")}function X(n,s,e){let t=e?n.columns:n.columns-1;if(s<0||s>t)throw new RangeError("Column index out of range")}function ht(n,s){if(s.to1DArray&&(s=s.to1DArray()),s.length!==n.columns)throw new RangeError("vector size must be the same as the number of columns");return s}function at(n,s){if(s.to1DArray&&(s=s.to1DArray()),s.length!==n.rows)throw new RangeError("vector size must be the same as the number of rows");return s}function Vt(n,s){if(!G.isAnyArray(s))throw new TypeError("row indices must be an array");for(let e=0;e<s.length;e++)if(s[e]<0||s[e]>=n.rows)throw new RangeError("row indices are out of range")}function Pt(n,s){if(!G.isAnyArray(s))throw new TypeError("column indices must be an array");for(let e=0;e<s.length;e++)if(s[e]<0||s[e]>=n.columns)throw new RangeError("column indices are out of range")}function Nt(n,s,e,t,r){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(dt("startRow",s),dt("endRow",e),dt("startColumn",t),dt("endColumn",r),s>e||t>r||s<0||s>=n.rows||e<0||e>=n.rows||t<0||t>=n.columns||r<0||r>=n.columns)throw new RangeError("Submatrix indices are out of range")}function Mt(n,s=0){let e=[];for(let t=0;t<n;t++)e.push(s);return e}function dt(n,s){if(typeof s!="number")throw new TypeError(`${n} must be a number`)}function ut(n){if(n.isEmpty())throw new Error("Empty matrix has no elements to index")}function Ve(n){let s=Mt(n.rows);for(let e=0;e<n.rows;++e)for(let t=0;t<n.columns;++t)s[e]+=n.get(e,t);return s}function Pe(n){let s=Mt(n.columns);for(let e=0;e<n.rows;++e)for(let t=0;t<n.columns;++t)s[t]+=n.get(e,t);return s}function xe(n){let s=0;for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)s+=n.get(e,t);return s}function Le(n){let s=Mt(n.rows,1);for(let e=0;e<n.rows;++e)for(let t=0;t<n.columns;++t)s[e]*=n.get(e,t);return s}function ze(n){let s=Mt(n.columns,1);for(let e=0;e<n.rows;++e)for(let t=0;t<n.columns;++t)s[t]*=n.get(e,t);return s}function Ue(n){let s=1;for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)s*=n.get(e,t);return s}function _e(n,s,e){const t=n.rows,r=n.columns,o=[];for(let i=0;i<t;i++){let l=0,u=0,h=0;for(let g=0;g<r;g++)h=n.get(i,g)-e[i],l+=h,u+=h*h;s?o.push((u-l*l/r)/(r-1)):o.push((u-l*l/r)/r)}return o}function $e(n,s,e){const t=n.rows,r=n.columns,o=[];for(let i=0;i<r;i++){let l=0,u=0,h=0;for(let g=0;g<t;g++)h=n.get(g,i)-e[i],l+=h,u+=h*h;s?o.push((u-l*l/t)/(t-1)):o.push((u-l*l/t)/t)}return o}function Be(n,s,e){const t=n.rows,r=n.columns,o=t*r;let i=0,l=0,u=0;for(let h=0;h<t;h++)for(let g=0;g<r;g++)u=n.get(h,g)-e,i+=u,l+=u*u;return s?(l-i*i/o)/(o-1):(l-i*i/o)/o}function Oe(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)-s[e])}function Ge(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)-s[t])}function Ye(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)-s)}function We(n){const s=[];for(let e=0;e<n.rows;e++){let t=0;for(let r=0;r<n.columns;r++)t+=n.get(e,r)**2/(n.columns-1);s.push(Math.sqrt(t))}return s}function Qe(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)/s[e])}function Je(n){const s=[];for(let e=0;e<n.columns;e++){let t=0;for(let r=0;r<n.rows;r++)t+=n.get(r,e)**2/(n.rows-1);s.push(Math.sqrt(t))}return s}function Xe(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)/s[t])}function Ke(n){const s=n.size-1;let e=0;for(let t=0;t<n.columns;t++)for(let r=0;r<n.rows;r++)e+=n.get(r,t)**2/s;return Math.sqrt(e)}function Ze(n,s){for(let e=0;e<n.rows;e++)for(let t=0;t<n.columns;t++)n.set(e,t,n.get(e,t)/s)}class C{static from1DArray(s,e,t){if(s*e!==t.length)throw new RangeError("data length does not match given dimensions");let o=new k(s,e);for(let i=0;i<s;i++)for(let l=0;l<e;l++)o.set(i,l,t[i*e+l]);return o}static rowVector(s){let e=new k(1,s.length);for(let t=0;t<s.length;t++)e.set(0,t,s[t]);return e}static columnVector(s){let e=new k(s.length,1);for(let t=0;t<s.length;t++)e.set(t,0,s[t]);return e}static zeros(s,e){return new k(s,e)}static ones(s,e){return new k(s,e).fill(1)}static rand(s,e,t={}){if(typeof t!="object")throw new TypeError("options must be an object");const{random:r=Math.random}=t;let o=new k(s,e);for(let i=0;i<s;i++)for(let l=0;l<e;l++)o.set(i,l,r());return o}static randInt(s,e,t={}){if(typeof t!="object")throw new TypeError("options must be an object");const{min:r=0,max:o=1e3,random:i=Math.random}=t;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(r>=o)throw new RangeError("min must be smaller than max");let l=o-r,u=new k(s,e);for(let h=0;h<s;h++)for(let g=0;g<e;g++){let a=r+Math.round(i()*l);u.set(h,g,a)}return u}static eye(s,e,t){e===void 0&&(e=s),t===void 0&&(t=1);let r=Math.min(s,e),o=this.zeros(s,e);for(let i=0;i<r;i++)o.set(i,i,t);return o}static diag(s,e,t){let r=s.length;e===void 0&&(e=r),t===void 0&&(t=e);let o=Math.min(r,e,t),i=this.zeros(e,t);for(let l=0;l<o;l++)i.set(l,l,s[l]);return i}static min(s,e){s=this.checkMatrix(s),e=this.checkMatrix(e);let t=s.rows,r=s.columns,o=new k(t,r);for(let i=0;i<t;i++)for(let l=0;l<r;l++)o.set(i,l,Math.min(s.get(i,l),e.get(i,l)));return o}static max(s,e){s=this.checkMatrix(s),e=this.checkMatrix(e);let t=s.rows,r=s.columns,o=new this(t,r);for(let i=0;i<t;i++)for(let l=0;l<r;l++)o.set(i,l,Math.max(s.get(i,l),e.get(i,l)));return o}static checkMatrix(s){return C.isMatrix(s)?s:new k(s)}static isMatrix(s){return s!=null&&s.klass==="Matrix"}get size(){return this.rows*this.columns}apply(s){if(typeof s!="function")throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)s.call(this,e,t);return this}to1DArray(){let s=[];for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)s.push(this.get(e,t));return s}to2DArray(){let s=[];for(let e=0;e<this.rows;e++){s.push([]);for(let t=0;t<this.columns;t++)s[e].push(this.get(e,t))}return s}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let s=0;s<this.rows;s++)for(let e=0;e<=s;e++)if(this.get(s,e)!==this.get(e,s))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let s=0;s<this.rows;s++)if(this.get(s,s)!==0)return!1;return!0}isEchelonForm(){let s=0,e=0,t=-1,r=!0,o=!1;for(;s<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(s,e)===0?e++:this.get(s,e)===1&&e>t?(o=!0,t=e):(r=!1,o=!0);s++}return r}isReducedEchelonForm(){let s=0,e=0,t=-1,r=!0,o=!1;for(;s<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(s,e)===0?e++:this.get(s,e)===1&&e>t?(o=!0,t=e):(r=!1,o=!0);for(let i=e+1;i<this.rows;i++)this.get(s,i)!==0&&(r=!1);s++}return r}echelonForm(){let s=this.clone(),e=0,t=0;for(;e<s.rows&&t<s.columns;){let r=e;for(let o=e;o<s.rows;o++)s.get(o,t)>s.get(r,t)&&(r=o);if(s.get(r,t)===0)t++;else{s.swapRows(e,r);let o=s.get(e,t);for(let i=t;i<s.columns;i++)s.set(e,i,s.get(e,i)/o);for(let i=e+1;i<s.rows;i++){let l=s.get(i,t)/s.get(e,t);s.set(i,t,0);for(let u=t+1;u<s.columns;u++)s.set(i,u,s.get(i,u)-s.get(e,u)*l)}e++,t++}}return s}reducedEchelonForm(){let s=this.echelonForm(),e=s.columns,t=s.rows,r=t-1;for(;r>=0;)if(s.maxRow(r)===0)r--;else{let o=0,i=!1;for(;o<t&&i===!1;)s.get(r,o)===1?i=!0:o++;for(let l=0;l<r;l++){let u=s.get(l,o);for(let h=o;h<e;h++){let g=s.get(l,h)-u*s.get(r,h);s.set(l,h,g)}}r--}return s}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(s={}){if(typeof s!="object")throw new TypeError("options must be an object");const{rows:e=1,columns:t=1}=s;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(t)||t<=0)throw new TypeError("columns must be a positive integer");let r=new k(this.rows*e,this.columns*t);for(let o=0;o<e;o++)for(let i=0;i<t;i++)r.setSubMatrix(this,this.rows*o,this.columns*i);return r}fill(s){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,s);return this}neg(){return this.mulS(-1)}getRow(s){J(this,s);let e=[];for(let t=0;t<this.columns;t++)e.push(this.get(s,t));return e}getRowVector(s){return k.rowVector(this.getRow(s))}setRow(s,e){J(this,s),e=ht(this,e);for(let t=0;t<this.columns;t++)this.set(s,t,e[t]);return this}swapRows(s,e){J(this,s),J(this,e);for(let t=0;t<this.columns;t++){let r=this.get(s,t);this.set(s,t,this.get(e,t)),this.set(e,t,r)}return this}getColumn(s){X(this,s);let e=[];for(let t=0;t<this.rows;t++)e.push(this.get(t,s));return e}getColumnVector(s){return k.columnVector(this.getColumn(s))}setColumn(s,e){X(this,s),e=at(this,e);for(let t=0;t<this.rows;t++)this.set(t,s,e[t]);return this}swapColumns(s,e){X(this,s),X(this,e);for(let t=0;t<this.rows;t++){let r=this.get(t,s);this.set(t,s,this.get(t,e)),this.set(t,e,r)}return this}addRowVector(s){s=ht(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)+s[t]);return this}subRowVector(s){s=ht(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)-s[t]);return this}mulRowVector(s){s=ht(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)*s[t]);return this}divRowVector(s){s=ht(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)/s[t]);return this}addColumnVector(s){s=at(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)+s[e]);return this}subColumnVector(s){s=at(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)-s[e]);return this}mulColumnVector(s){s=at(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)*s[e]);return this}divColumnVector(s){s=at(this,s);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,this.get(e,t)/s[e]);return this}mulRow(s,e){J(this,s);for(let t=0;t<this.columns;t++)this.set(s,t,this.get(s,t)*e);return this}mulColumn(s,e){X(this,s);for(let t=0;t<this.rows;t++)this.set(t,s,this.get(t,s)*e);return this}max(s){if(this.isEmpty())return NaN;switch(s){case"row":{const e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)>e[t]&&(e[t]=this.get(t,r));return e}case"column":{const e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)>e[r]&&(e[r]=this.get(t,r));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}default:throw new Error(`invalid option: ${s}`)}}maxIndex(){ut(this);let s=this.get(0,0),e=[0,0];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)>s&&(s=this.get(t,r),e[0]=t,e[1]=r);return e}min(s){if(this.isEmpty())return NaN;switch(s){case"row":{const e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)<e[t]&&(e[t]=this.get(t,r));return e}case"column":{const e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)<e[r]&&(e[r]=this.get(t,r));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}default:throw new Error(`invalid option: ${s}`)}}minIndex(){ut(this);let s=this.get(0,0),e=[0,0];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)<s&&(s=this.get(t,r),e[0]=t,e[1]=r);return e}maxRow(s){if(J(this,s),this.isEmpty())return NaN;let e=this.get(s,0);for(let t=1;t<this.columns;t++)this.get(s,t)>e&&(e=this.get(s,t));return e}maxRowIndex(s){J(this,s),ut(this);let e=this.get(s,0),t=[s,0];for(let r=1;r<this.columns;r++)this.get(s,r)>e&&(e=this.get(s,r),t[1]=r);return t}minRow(s){if(J(this,s),this.isEmpty())return NaN;let e=this.get(s,0);for(let t=1;t<this.columns;t++)this.get(s,t)<e&&(e=this.get(s,t));return e}minRowIndex(s){J(this,s),ut(this);let e=this.get(s,0),t=[s,0];for(let r=1;r<this.columns;r++)this.get(s,r)<e&&(e=this.get(s,r),t[1]=r);return t}maxColumn(s){if(X(this,s),this.isEmpty())return NaN;let e=this.get(0,s);for(let t=1;t<this.rows;t++)this.get(t,s)>e&&(e=this.get(t,s));return e}maxColumnIndex(s){X(this,s),ut(this);let e=this.get(0,s),t=[0,s];for(let r=1;r<this.rows;r++)this.get(r,s)>e&&(e=this.get(r,s),t[0]=r);return t}minColumn(s){if(X(this,s),this.isEmpty())return NaN;let e=this.get(0,s);for(let t=1;t<this.rows;t++)this.get(t,s)<e&&(e=this.get(t,s));return e}minColumnIndex(s){X(this,s),ut(this);let e=this.get(0,s),t=[0,s];for(let r=1;r<this.rows;r++)this.get(r,s)<e&&(e=this.get(r,s),t[0]=r);return t}diag(){let s=Math.min(this.rows,this.columns),e=[];for(let t=0;t<s;t++)e.push(this.get(t,t));return e}norm(s="frobenius"){switch(s){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${s}`)}}cumulativeSum(){let s=0;for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)s+=this.get(e,t),this.set(e,t,s);return this}dot(s){C.isMatrix(s)&&(s=s.to1DArray());let e=this.to1DArray();if(e.length!==s.length)throw new RangeError("vectors do not have the same size");let t=0;for(let r=0;r<e.length;r++)t+=e[r]*s[r];return t}mmul(s){s=k.checkMatrix(s);let e=this.rows,t=this.columns,r=s.columns,o=new k(e,r),i=new Float64Array(t);for(let l=0;l<r;l++){for(let u=0;u<t;u++)i[u]=s.get(u,l);for(let u=0;u<e;u++){let h=0;for(let g=0;g<t;g++)h+=this.get(u,g)*i[g];o.set(u,l,h)}}return o}mpow(s){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(s)||s<0)throw new RangeError("Exponent must be a non-negative integer");let e=k.eye(this.rows),t=this;for(let r=s;r>=1;r/=2)r&1&&(e=e.mmul(t)),t=t.mmul(t);return e}strassen2x2(s){s=k.checkMatrix(s);let e=new k(2,2);const t=this.get(0,0),r=s.get(0,0),o=this.get(0,1),i=s.get(0,1),l=this.get(1,0),u=s.get(1,0),h=this.get(1,1),g=s.get(1,1),a=(t+h)*(r+g),w=(l+h)*r,p=t*(i-g),m=h*(u-r),d=(t+o)*g,R=(l-t)*(r+i),f=(o-h)*(u+g),S=a+m-d+f,y=p+d,M=w+m,E=a-w+p+R;return e.set(0,0,S),e.set(0,1,y),e.set(1,0,M),e.set(1,1,E),e}strassen3x3(s){s=k.checkMatrix(s);let e=new k(3,3);const t=this.get(0,0),r=this.get(0,1),o=this.get(0,2),i=this.get(1,0),l=this.get(1,1),u=this.get(1,2),h=this.get(2,0),g=this.get(2,1),a=this.get(2,2),w=s.get(0,0),p=s.get(0,1),m=s.get(0,2),d=s.get(1,0),R=s.get(1,1),f=s.get(1,2),S=s.get(2,0),y=s.get(2,1),M=s.get(2,2),E=(t+r+o-i-l-g-a)*R,I=(t-i)*(-p+R),T=l*(-w+p+d-R-f-S+M),D=(-t+i+l)*(w-p+R),F=(i+l)*(-w+p),c=t*w,b=(-t+h+g)*(w-m+f),j=(-t+h)*(m-f),v=(h+g)*(-w+m),x=(t+r+o-l-u-h-g)*f,V=g*(-w+m+d-R-f-S+y),L=(-o+g+a)*(R+S-y),z=(o-a)*(R-y),$=o*S,K=(g+a)*(-S+y),U=(-o+l+u)*(f+S-M),A=(o-u)*(f-M),H=(l+u)*(-S+M),q=r*d,B=u*y,Y=i*m,W=h*p,_=a*M,re=c+$+q,oe=E+D+F+c+L+$+K,ne=c+b+v+x+$+U+H,ie=I+T+D+c+$+U+A,le=I+D+F+c+B,ue=$+U+A+H+Y,he=c+b+j+V+L+z+$,ae=L+z+$+K+W,fe=c+b+j+v+_;return e.set(0,0,re),e.set(0,1,oe),e.set(0,2,ne),e.set(1,0,ie),e.set(1,1,le),e.set(1,2,ue),e.set(2,0,he),e.set(2,1,ae),e.set(2,2,fe),e}mmulStrassen(s){s=k.checkMatrix(s);let e=this.clone(),t=e.rows,r=e.columns,o=s.rows,i=s.columns;r!==o&&console.warn(`Multiplying ${t} x ${r} and ${o} x ${i} matrix: dimensions do not match.`);function l(a,w,p){let m=a.rows,d=a.columns;if(m===w&&d===p)return a;{let R=C.zeros(w,p);return R=R.setSubMatrix(a,0,0),R}}let u=Math.max(t,o),h=Math.max(r,i);e=l(e,u,h),s=l(s,u,h);function g(a,w,p,m){if(p<=512||m<=512)return a.mmul(w);p%2===1&&m%2===1?(a=l(a,p+1,m+1),w=l(w,p+1,m+1)):p%2===1?(a=l(a,p+1,m),w=l(w,p+1,m)):m%2===1&&(a=l(a,p,m+1),w=l(w,p,m+1));let d=parseInt(a.rows/2,10),R=parseInt(a.columns/2,10),f=a.subMatrix(0,d-1,0,R-1),S=w.subMatrix(0,d-1,0,R-1),y=a.subMatrix(0,d-1,R,a.columns-1),M=w.subMatrix(0,d-1,R,w.columns-1),E=a.subMatrix(d,a.rows-1,0,R-1),I=w.subMatrix(d,w.rows-1,0,R-1),T=a.subMatrix(d,a.rows-1,R,a.columns-1),D=w.subMatrix(d,w.rows-1,R,w.columns-1),F=g(C.add(f,T),C.add(S,D),d,R),c=g(C.add(E,T),S,d,R),b=g(f,C.sub(M,D),d,R),j=g(T,C.sub(I,S),d,R),v=g(C.add(f,y),D,d,R),x=g(C.sub(E,f),C.add(S,M),d,R),V=g(C.sub(y,T),C.add(I,D),d,R),L=C.add(F,j);L.sub(v),L.add(V);let z=C.add(b,v),$=C.add(c,j),K=C.sub(F,c);K.add(b),K.add(x);let U=C.zeros(2*L.rows,2*L.columns);return U=U.setSubMatrix(L,0,0),U=U.setSubMatrix(z,L.rows,0),U=U.setSubMatrix($,0,L.columns),U=U.setSubMatrix(K,L.rows,L.columns),U.subMatrix(0,p-1,0,m-1)}return g(e,s,u,h)}scaleRows(s={}){if(typeof s!="object")throw new TypeError("options must be an object");const{min:e=0,max:t=1}=s;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(t))throw new TypeError("max must be a number");if(e>=t)throw new RangeError("min must be smaller than max");let r=new k(this.rows,this.columns);for(let o=0;o<this.rows;o++){const i=this.getRow(o);i.length>0&&Ot(i,{min:e,max:t,output:i}),r.setRow(o,i)}return r}scaleColumns(s={}){if(typeof s!="object")throw new TypeError("options must be an object");const{min:e=0,max:t=1}=s;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(t))throw new TypeError("max must be a number");if(e>=t)throw new RangeError("min must be smaller than max");let r=new k(this.rows,this.columns);for(let o=0;o<this.columns;o++){const i=this.getColumn(o);i.length&&Ot(i,{min:e,max:t,output:i}),r.setColumn(o,i)}return r}flipRows(){const s=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let t=0;t<s;t++){let r=this.get(e,t),o=this.get(e,this.columns-1-t);this.set(e,t,o),this.set(e,this.columns-1-t,r)}return this}flipColumns(){const s=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let t=0;t<s;t++){let r=this.get(t,e),o=this.get(this.rows-1-t,e);this.set(t,e,o),this.set(this.rows-1-t,e,r)}return this}kroneckerProduct(s){s=k.checkMatrix(s);let e=this.rows,t=this.columns,r=s.rows,o=s.columns,i=new k(e*r,t*o);for(let l=0;l<e;l++)for(let u=0;u<t;u++)for(let h=0;h<r;h++)for(let g=0;g<o;g++)i.set(r*l+h,o*u+g,this.get(l,u)*s.get(h,g));return i}kroneckerSum(s){if(s=k.checkMatrix(s),!this.isSquare()||!s.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,t=s.rows,r=this.kroneckerProduct(k.eye(t,t)),o=k.eye(e,e).kroneckerProduct(s);return r.add(o)}transpose(){let s=new k(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)s.set(t,e,this.get(e,t));return s}sortRows(s=Yt){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(s));return this}sortColumns(s=Yt){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(s));return this}subMatrix(s,e,t,r){Nt(this,s,e,t,r);let o=new k(e-s+1,r-t+1);for(let i=s;i<=e;i++)for(let l=t;l<=r;l++)o.set(i-s,l-t,this.get(i,l));return o}subMatrixRow(s,e,t){if(e===void 0&&(e=0),t===void 0&&(t=this.columns-1),e>t||e<0||e>=this.columns||t<0||t>=this.columns)throw new RangeError("Argument out of range");let r=new k(s.length,t-e+1);for(let o=0;o<s.length;o++)for(let i=e;i<=t;i++){if(s[o]<0||s[o]>=this.rows)throw new RangeError(`Row index out of range: ${s[o]}`);r.set(o,i-e,this.get(s[o],i))}return r}subMatrixColumn(s,e,t){if(e===void 0&&(e=0),t===void 0&&(t=this.rows-1),e>t||e<0||e>=this.rows||t<0||t>=this.rows)throw new RangeError("Argument out of range");let r=new k(t-e+1,s.length);for(let o=0;o<s.length;o++)for(let i=e;i<=t;i++){if(s[o]<0||s[o]>=this.columns)throw new RangeError(`Column index out of range: ${s[o]}`);r.set(i-e,o,this.get(i,s[o]))}return r}setSubMatrix(s,e,t){if(s=k.checkMatrix(s),s.isEmpty())return this;let r=e+s.rows-1,o=t+s.columns-1;Nt(this,e,r,t,o);for(let i=0;i<s.rows;i++)for(let l=0;l<s.columns;l++)this.set(e+i,t+l,s.get(i,l));return this}selection(s,e){Vt(this,s),Pt(this,e);let t=new k(s.length,e.length);for(let r=0;r<s.length;r++){let o=s[r];for(let i=0;i<e.length;i++){let l=e[i];t.set(r,i,this.get(o,l))}}return t}trace(){let s=Math.min(this.rows,this.columns),e=0;for(let t=0;t<s;t++)e+=this.get(t,t);return e}clone(){return this.constructor.copy(this,new k(this.rows,this.columns))}static copy(s,e){for(const[t,r,o]of s.entries())e.set(t,r,o);return e}sum(s){switch(s){case"row":return Ve(this);case"column":return Pe(this);case void 0:return xe(this);default:throw new Error(`invalid option: ${s}`)}}product(s){switch(s){case"row":return Le(this);case"column":return ze(this);case void 0:return Ue(this);default:throw new Error(`invalid option: ${s}`)}}mean(s){const e=this.sum(s);switch(s){case"row":{for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e}case"column":{for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e}case void 0:return e/this.size;default:throw new Error(`invalid option: ${s}`)}}variance(s,e={}){if(typeof s=="object"&&(e=s,s=void 0),typeof e!="object")throw new TypeError("options must be an object");const{unbiased:t=!0,mean:r=this.mean(s)}=e;if(typeof t!="boolean")throw new TypeError("unbiased must be a boolean");switch(s){case"row":{if(!G.isAnyArray(r))throw new TypeError("mean must be an array");return _e(this,t,r)}case"column":{if(!G.isAnyArray(r))throw new TypeError("mean must be an array");return $e(this,t,r)}case void 0:{if(typeof r!="number")throw new TypeError("mean must be a number");return Be(this,t,r)}default:throw new Error(`invalid option: ${s}`)}}standardDeviation(s,e){typeof s=="object"&&(e=s,s=void 0);const t=this.variance(s,e);if(s===void 0)return Math.sqrt(t);for(let r=0;r<t.length;r++)t[r]=Math.sqrt(t[r]);return t}center(s,e={}){if(typeof s=="object"&&(e=s,s=void 0),typeof e!="object")throw new TypeError("options must be an object");const{center:t=this.mean(s)}=e;switch(s){case"row":{if(!G.isAnyArray(t))throw new TypeError("center must be an array");return Oe(this,t),this}case"column":{if(!G.isAnyArray(t))throw new TypeError("center must be an array");return Ge(this,t),this}case void 0:{if(typeof t!="number")throw new TypeError("center must be a number");return Ye(this,t),this}default:throw new Error(`invalid option: ${s}`)}}scale(s,e={}){if(typeof s=="object"&&(e=s,s=void 0),typeof e!="object")throw new TypeError("options must be an object");let t=e.scale;switch(s){case"row":{if(t===void 0)t=We(this);else if(!G.isAnyArray(t))throw new TypeError("scale must be an array");return Qe(this,t),this}case"column":{if(t===void 0)t=Je(this);else if(!G.isAnyArray(t))throw new TypeError("scale must be an array");return Xe(this,t),this}case void 0:{if(t===void 0)t=Ke(this);else if(typeof t!="number")throw new TypeError("scale must be a number");return Ze(this,t),this}default:throw new Error(`invalid option: ${s}`)}}toString(s){return Xt(this,s)}[Symbol.iterator](){return this.entries()}*entries(){for(let s=0;s<this.rows;s++)for(let e=0;e<this.columns;e++)yield[s,e,this.get(s,e)]}*values(){for(let s=0;s<this.rows;s++)for(let e=0;e<this.columns;e++)yield this.get(s,e)}}C.prototype.klass="Matrix";typeof Symbol<"u"&&(C.prototype[Symbol.for("nodejs.util.inspect.custom")]=Fe);function Yt(n,s){return n-s}function Ae(n){return n.every(s=>typeof s=="number")}C.random=C.rand;C.randomInt=C.randInt;C.diagonal=C.diag;C.prototype.diagonal=C.prototype.diag;C.identity=C.eye;C.prototype.negate=C.prototype.neg;C.prototype.tensorProduct=C.prototype.kroneckerProduct;var gt,qt,ft;let k=(ft=class extends C{constructor(e,t){super();Rt(this,gt);_t(this,"data");if(ft.isMatrix(e))Tt(this,gt,qt).call(this,e.rows,e.columns),ft.copy(e,this);else if(Number.isInteger(e)&&e>=0)Tt(this,gt,qt).call(this,e,t);else if(G.isAnyArray(e)){const r=e;if(e=r.length,t=e?r[0].length:0,typeof t!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<e;o++){if(r[o].length!==t)throw new RangeError("Inconsistent array dimensions");if(!Ae(r[o]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[o]))}this.rows=e,this.columns=t}else throw new TypeError("First argument must be a positive number or an array")}set(e,t,r){return this.data[e][t]=r,this}get(e,t){return this.data[e][t]}removeRow(e){return J(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return t===void 0&&(t=e,e=this.rows),J(this,e,!0),t=Float64Array.from(ht(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){X(this,e);for(let t=0;t<this.rows;t++){const r=new Float64Array(this.columns-1);for(let o=0;o<e;o++)r[o]=this.data[t][o];for(let o=e+1;o<this.columns;o++)r[o-1]=this.data[t][o];this.data[t]=r}return this.columns-=1,this}addColumn(e,t){typeof t>"u"&&(t=e,e=this.columns),X(this,e,!0),t=at(this,t);for(let r=0;r<this.rows;r++){const o=new Float64Array(this.columns+1);let i=0;for(;i<e;i++)o[i]=this.data[r][i];for(o[i++]=t[r];i<this.columns+1;i++)o[i]=this.data[r][i-1];this.data[r]=o}return this.columns+=1,this}},gt=new WeakSet,qt=function(e,t){if(this.data=[],Number.isInteger(t)&&t>=0)for(let r=0;r<e;r++)this.data.push(new Float64Array(t));else throw new TypeError("nColumns must be a positive integer");this.rows=e,this.columns=t},ft);qe(C,k);var O;const St=class St extends C{constructor(e){super();Rt(this,O,void 0);if(k.isMatrix(e)){if(!e.isSymmetric())throw new TypeError("not symmetric data");mt(this,O,k.copy(e,new k(e.rows,e.rows)))}else if(Number.isInteger(e)&&e>=0)mt(this,O,new k(e,e));else if(mt(this,O,new k(e)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Z(this,O).size}get rows(){return Z(this,O).rows}get columns(){return Z(this,O).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(e){return k.isMatrix(e)&&e.klassType==="SymmetricMatrix"}static zeros(e){return new this(e)}static ones(e){return new this(e).fill(1)}clone(){const e=new St(this.diagonalSize);for(const[t,r,o]of this.upperRightEntries())e.set(t,r,o);return e}toMatrix(){return new k(this)}get(e,t){return Z(this,O).get(e,t)}set(e,t,r){return Z(this,O).set(e,t,r),Z(this,O).set(t,e,r),this}removeCross(e){return Z(this,O).removeRow(e),Z(this,O).removeColumn(e),this}addCross(e,t){t===void 0&&(t=e,e=this.diagonalSize);const r=t.slice();return r.splice(e,1),Z(this,O).addRow(e,r),Z(this,O).addColumn(e,t),this}applyMask(e){if(e.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const t=[];for(const[r,o]of e.entries())o||t.push(r);t.reverse();for(const r of t)this.removeCross(r);return this}toCompact(){const{diagonalSize:e}=this,t=new Array(e*(e+1)/2);for(let r=0,o=0,i=0;i<t.length;i++)t[i]=this.get(o,r),++r>=e&&(r=++o);return t}static fromCompact(e){const t=e.length,r=(Math.sqrt(8*t+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(e)}`);const o=new St(r);for(let i=0,l=0,u=0;u<t;u++)o.set(i,l,e[u]),++i>=r&&(i=++l);return o}*upperRightEntries(){for(let e=0,t=0;e<this.diagonalSize;void 0){const r=this.get(e,t);yield[e,t,r],++t>=this.diagonalSize&&(t=++e)}}*upperRightValues(){for(let e=0,t=0;e<this.diagonalSize;void 0)yield this.get(e,t),++t>=this.diagonalSize&&(t=++e)}};O=new WeakMap;let lt=St;lt.prototype.klassType="SymmetricMatrix";class Et extends lt{static isDistanceMatrix(s){return lt.isSymmetricMatrix(s)&&s.klassSubType==="DistanceMatrix"}constructor(s){if(super(s),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(s,e,t){return s===e&&(t=0),super.set(s,e,t)}addCross(s,e){return e===void 0&&(e=s,s=this.diagonalSize),e=e.slice(),e[s]=0,super.addCross(s,e)}toSymmetricMatrix(){return new lt(this)}clone(){const s=new Et(this.diagonalSize);for(const[e,t,r]of this.upperRightEntries())e!==t&&s.set(e,t,r);return s}toCompact(){const{diagonalSize:s}=this,e=(s-1)*s/2,t=new Array(e);for(let r=1,o=0,i=0;i<t.length;i++)t[i]=this.get(o,r),++r>=s&&(r=++o+1);return t}static fromCompact(s){const e=s.length;if(e===0)return new this(0);const t=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(t))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(s)}`);const r=new this(t);for(let o=1,i=0,l=0;l<e;l++)r.set(o,i,s[l]),++o>=t&&(o=++i+1);return r}}Et.prototype.klassSubType="DistanceMatrix";class st extends C{constructor(s,e,t){super(),this.matrix=s,this.rows=e,this.columns=t}}class He extends st{constructor(s,e){X(s,e),super(s,s.rows,1),this.column=e}set(s,e,t){return this.matrix.set(s,this.column,t),this}get(s){return this.matrix.get(s,this.column)}}class ts extends st{constructor(s,e){Pt(s,e),super(s,s.rows,e.length),this.columnIndices=e}set(s,e,t){return this.matrix.set(s,this.columnIndices[e],t),this}get(s,e){return this.matrix.get(s,this.columnIndices[e])}}class es extends st{constructor(s){super(s,s.rows,s.columns)}set(s,e,t){return this.matrix.set(s,this.columns-e-1,t),this}get(s,e){return this.matrix.get(s,this.columns-e-1)}}class ss extends st{constructor(s){super(s,s.rows,s.columns)}set(s,e,t){return this.matrix.set(this.rows-s-1,e,t),this}get(s,e){return this.matrix.get(this.rows-s-1,e)}}class rs extends st{constructor(s,e){J(s,e),super(s,1,s.columns),this.row=e}set(s,e,t){return this.matrix.set(this.row,e,t),this}get(s,e){return this.matrix.get(this.row,e)}}class os extends st{constructor(s,e){Vt(s,e),super(s,e.length,s.columns),this.rowIndices=e}set(s,e,t){return this.matrix.set(this.rowIndices[s],e,t),this}get(s,e){return this.matrix.get(this.rowIndices[s],e)}}class bt extends st{constructor(s,e,t){Vt(s,e),Pt(s,t),super(s,e.length,t.length),this.rowIndices=e,this.columnIndices=t}set(s,e,t){return this.matrix.set(this.rowIndices[s],this.columnIndices[e],t),this}get(s,e){return this.matrix.get(this.rowIndices[s],this.columnIndices[e])}}class ns extends st{constructor(s,e,t,r,o){Nt(s,e,t,r,o),super(s,t-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(s,e,t){return this.matrix.set(this.startRow+s,this.startColumn+e,t),this}get(s,e){return this.matrix.get(this.startRow+s,this.startColumn+e)}}let is=class extends st{constructor(s){super(s,s.columns,s.rows)}set(s,e,t){return this.matrix.set(e,s,t),this}get(s,e){return this.matrix.get(e,s)}};class Kt extends C{constructor(s,e={}){const{rows:t=1}=e;if(s.length%t!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=t,this.columns=s.length/t,this.data=s}set(s,e,t){let r=this._calculateIndex(s,e);return this.data[r]=t,this}get(s,e){let t=this._calculateIndex(s,e);return this.data[t]}_calculateIndex(s,e){return s*this.columns+e}}class Q extends C{constructor(s){super(),this.data=s,this.rows=s.length,this.columns=s[0].length}set(s,e,t){return this.data[s][e]=t,this}get(s,e){return this.data[s][e]}}function ls(n,s){if(G.isAnyArray(n))return n[0]&&G.isAnyArray(n[0])?new Q(n):new Kt(n,s);throw new Error("the argument is not an array")}class jt{constructor(s){s=Q.checkMatrix(s);let e=s.clone(),t=e.rows,r=e.columns,o=new Float64Array(t),i=1,l,u,h,g,a,w,p,m,d;for(l=0;l<t;l++)o[l]=l;for(m=new Float64Array(t),u=0;u<r;u++){for(l=0;l<t;l++)m[l]=e.get(l,u);for(l=0;l<t;l++){for(d=Math.min(l,u),a=0,h=0;h<d;h++)a+=e.get(l,h)*m[h];m[l]-=a,e.set(l,u,m[l])}for(g=u,l=u+1;l<t;l++)Math.abs(m[l])>Math.abs(m[g])&&(g=l);if(g!==u){for(h=0;h<r;h++)w=e.get(g,h),e.set(g,h,e.get(u,h)),e.set(u,h,w);p=o[g],o[g]=o[u],o[u]=p,i=-i}if(u<t&&e.get(u,u)!==0)for(l=u+1;l<t;l++)e.set(l,u,e.get(l,u)/e.get(u,u))}this.LU=e,this.pivotVector=o,this.pivotSign=i}isSingular(){let s=this.LU,e=s.columns;for(let t=0;t<e;t++)if(s.get(t,t)===0)return!0;return!1}solve(s){s=k.checkMatrix(s);let e=this.LU;if(e.rows!==s.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r=s.columns,o=s.subMatrixRow(this.pivotVector,0,r-1),i=e.columns,l,u,h;for(h=0;h<i;h++)for(l=h+1;l<i;l++)for(u=0;u<r;u++)o.set(l,u,o.get(l,u)-o.get(h,u)*e.get(l,h));for(h=i-1;h>=0;h--){for(u=0;u<r;u++)o.set(h,u,o.get(h,u)/e.get(h,h));for(l=0;l<h;l++)for(u=0;u<r;u++)o.set(l,u,o.get(l,u)-o.get(h,u)*e.get(l,h))}return o}get determinant(){let s=this.LU;if(!s.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,t=s.columns;for(let r=0;r<t;r++)e*=s.get(r,r);return e}get lowerTriangularMatrix(){let s=this.LU,e=s.rows,t=s.columns,r=new k(e,t);for(let o=0;o<e;o++)for(let i=0;i<t;i++)o>i?r.set(o,i,s.get(o,i)):o===i?r.set(o,i,1):r.set(o,i,0);return r}get upperTriangularMatrix(){let s=this.LU,e=s.rows,t=s.columns,r=new k(e,t);for(let o=0;o<e;o++)for(let i=0;i<t;i++)o<=i?r.set(o,i,s.get(o,i)):r.set(o,i,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function et(n,s){let e=0;return Math.abs(n)>Math.abs(s)?(e=s/n,Math.abs(n)*Math.sqrt(1+e*e)):s!==0?(e=n/s,Math.abs(s)*Math.sqrt(1+e*e)):0}class xt{constructor(s){s=Q.checkMatrix(s);let e=s.clone(),t=s.rows,r=s.columns,o=new Float64Array(r),i,l,u,h;for(u=0;u<r;u++){let g=0;for(i=u;i<t;i++)g=et(g,e.get(i,u));if(g!==0){for(e.get(u,u)<0&&(g=-g),i=u;i<t;i++)e.set(i,u,e.get(i,u)/g);for(e.set(u,u,e.get(u,u)+1),l=u+1;l<r;l++){for(h=0,i=u;i<t;i++)h+=e.get(i,u)*e.get(i,l);for(h=-h/e.get(u,u),i=u;i<t;i++)e.set(i,l,e.get(i,l)+h*e.get(i,u))}}o[u]=-g}this.QR=e,this.Rdiag=o}solve(s){s=k.checkMatrix(s);let e=this.QR,t=e.rows;if(s.rows!==t)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r=s.columns,o=s.clone(),i=e.columns,l,u,h,g;for(h=0;h<i;h++)for(u=0;u<r;u++){for(g=0,l=h;l<t;l++)g+=e.get(l,h)*o.get(l,u);for(g=-g/e.get(h,h),l=h;l<t;l++)o.set(l,u,o.get(l,u)+g*e.get(l,h))}for(h=i-1;h>=0;h--){for(u=0;u<r;u++)o.set(h,u,o.get(h,u)/this.Rdiag[h]);for(l=0;l<h;l++)for(u=0;u<r;u++)o.set(l,u,o.get(l,u)-o.get(h,u)*e.get(l,h))}return o.subMatrix(0,i-1,0,r-1)}isFullRank(){let s=this.QR.columns;for(let e=0;e<s;e++)if(this.Rdiag[e]===0)return!1;return!0}get upperTriangularMatrix(){let s=this.QR,e=s.columns,t=new k(e,e),r,o;for(r=0;r<e;r++)for(o=0;o<e;o++)r<o?t.set(r,o,s.get(r,o)):r===o?t.set(r,o,this.Rdiag[r]):t.set(r,o,0);return t}get orthogonalMatrix(){let s=this.QR,e=s.rows,t=s.columns,r=new k(e,t),o,i,l,u;for(l=t-1;l>=0;l--){for(o=0;o<e;o++)r.set(o,l,0);for(r.set(l,l,1),i=l;i<t;i++)if(s.get(l,l)!==0){for(u=0,o=l;o<e;o++)u+=s.get(o,l)*r.get(o,i);for(u=-u/s.get(l,l),o=l;o<e;o++)r.set(o,i,r.get(o,i)+u*s.get(o,l))}}return r}}class ct{constructor(s,e={}){if(s=Q.checkMatrix(s),s.isEmpty())throw new Error("Matrix must be non-empty");let t=s.rows,r=s.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:l=!1}=e;let u=!!o,h=!!i,g=!1,a;if(t<r)if(!l)a=s.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{a=s.transpose(),t=a.rows,r=a.columns,g=!0;let c=u;u=h,h=c}else a=s.clone();let w=Math.min(t,r),p=Math.min(t+1,r),m=new Float64Array(p),d=new k(t,w),R=new k(r,r),f=new Float64Array(r),S=new Float64Array(t),y=new Float64Array(p);for(let c=0;c<p;c++)y[c]=c;let M=Math.min(t-1,r),E=Math.max(0,Math.min(r-2,t)),I=Math.max(M,E);for(let c=0;c<I;c++){if(c<M){m[c]=0;for(let b=c;b<t;b++)m[c]=et(m[c],a.get(b,c));if(m[c]!==0){a.get(c,c)<0&&(m[c]=-m[c]);for(let b=c;b<t;b++)a.set(b,c,a.get(b,c)/m[c]);a.set(c,c,a.get(c,c)+1)}m[c]=-m[c]}for(let b=c+1;b<r;b++){if(c<M&&m[c]!==0){let j=0;for(let v=c;v<t;v++)j+=a.get(v,c)*a.get(v,b);j=-j/a.get(c,c);for(let v=c;v<t;v++)a.set(v,b,a.get(v,b)+j*a.get(v,c))}f[b]=a.get(c,b)}if(u&&c<M)for(let b=c;b<t;b++)d.set(b,c,a.get(b,c));if(c<E){f[c]=0;for(let b=c+1;b<r;b++)f[c]=et(f[c],f[b]);if(f[c]!==0){f[c+1]<0&&(f[c]=0-f[c]);for(let b=c+1;b<r;b++)f[b]/=f[c];f[c+1]+=1}if(f[c]=-f[c],c+1<t&&f[c]!==0){for(let b=c+1;b<t;b++)S[b]=0;for(let b=c+1;b<t;b++)for(let j=c+1;j<r;j++)S[b]+=f[j]*a.get(b,j);for(let b=c+1;b<r;b++){let j=-f[b]/f[c+1];for(let v=c+1;v<t;v++)a.set(v,b,a.get(v,b)+j*S[v])}}if(h)for(let b=c+1;b<r;b++)R.set(b,c,f[b])}}let T=Math.min(r,t+1);if(M<r&&(m[M]=a.get(M,M)),t<T&&(m[T-1]=0),E+1<T&&(f[E]=a.get(E,T-1)),f[T-1]=0,u){for(let c=M;c<w;c++){for(let b=0;b<t;b++)d.set(b,c,0);d.set(c,c,1)}for(let c=M-1;c>=0;c--)if(m[c]!==0){for(let b=c+1;b<w;b++){let j=0;for(let v=c;v<t;v++)j+=d.get(v,c)*d.get(v,b);j=-j/d.get(c,c);for(let v=c;v<t;v++)d.set(v,b,d.get(v,b)+j*d.get(v,c))}for(let b=c;b<t;b++)d.set(b,c,-d.get(b,c));d.set(c,c,1+d.get(c,c));for(let b=0;b<c-1;b++)d.set(b,c,0)}else{for(let b=0;b<t;b++)d.set(b,c,0);d.set(c,c,1)}}if(h)for(let c=r-1;c>=0;c--){if(c<E&&f[c]!==0)for(let b=c+1;b<r;b++){let j=0;for(let v=c+1;v<r;v++)j+=R.get(v,c)*R.get(v,b);j=-j/R.get(c+1,c);for(let v=c+1;v<r;v++)R.set(v,b,R.get(v,b)+j*R.get(v,c))}for(let b=0;b<r;b++)R.set(b,c,0);R.set(c,c,1)}let D=T-1,F=Number.EPSILON;for(;T>0;){let c,b;for(c=T-2;c>=-1&&c!==-1;c--){const j=Number.MIN_VALUE+F*Math.abs(m[c]+Math.abs(m[c+1]));if(Math.abs(f[c])<=j||Number.isNaN(f[c])){f[c]=0;break}}if(c===T-2)b=4;else{let j;for(j=T-1;j>=c&&j!==c;j--){let v=(j!==T?Math.abs(f[j]):0)+(j!==c+1?Math.abs(f[j-1]):0);if(Math.abs(m[j])<=F*v){m[j]=0;break}}j===c?b=3:j===T-1?b=1:(b=2,c=j)}switch(c++,b){case 1:{let j=f[T-2];f[T-2]=0;for(let v=T-2;v>=c;v--){let x=et(m[v],j),V=m[v]/x,L=j/x;if(m[v]=x,v!==c&&(j=-L*f[v-1],f[v-1]=V*f[v-1]),h)for(let z=0;z<r;z++)x=V*R.get(z,v)+L*R.get(z,T-1),R.set(z,T-1,-L*R.get(z,v)+V*R.get(z,T-1)),R.set(z,v,x)}break}case 2:{let j=f[c-1];f[c-1]=0;for(let v=c;v<T;v++){let x=et(m[v],j),V=m[v]/x,L=j/x;if(m[v]=x,j=-L*f[v],f[v]=V*f[v],u)for(let z=0;z<t;z++)x=V*d.get(z,v)+L*d.get(z,c-1),d.set(z,c-1,-L*d.get(z,v)+V*d.get(z,c-1)),d.set(z,v,x)}break}case 3:{const j=Math.max(Math.abs(m[T-1]),Math.abs(m[T-2]),Math.abs(f[T-2]),Math.abs(m[c]),Math.abs(f[c])),v=m[T-1]/j,x=m[T-2]/j,V=f[T-2]/j,L=m[c]/j,z=f[c]/j,$=((x+v)*(x-v)+V*V)/2,K=v*V*(v*V);let U=0;($!==0||K!==0)&&($<0?U=0-Math.sqrt($*$+K):U=Math.sqrt($*$+K),U=K/($+U));let A=(L+v)*(L-v)+U,H=L*z;for(let q=c;q<T-1;q++){let B=et(A,H);B===0&&(B=Number.MIN_VALUE);let Y=A/B,W=H/B;if(q!==c&&(f[q-1]=B),A=Y*m[q]+W*f[q],f[q]=Y*f[q]-W*m[q],H=W*m[q+1],m[q+1]=Y*m[q+1],h)for(let _=0;_<r;_++)B=Y*R.get(_,q)+W*R.get(_,q+1),R.set(_,q+1,-W*R.get(_,q)+Y*R.get(_,q+1)),R.set(_,q,B);if(B=et(A,H),B===0&&(B=Number.MIN_VALUE),Y=A/B,W=H/B,m[q]=B,A=Y*f[q]+W*m[q+1],m[q+1]=-W*f[q]+Y*m[q+1],H=W*f[q+1],f[q+1]=Y*f[q+1],u&&q<t-1)for(let _=0;_<t;_++)B=Y*d.get(_,q)+W*d.get(_,q+1),d.set(_,q+1,-W*d.get(_,q)+Y*d.get(_,q+1)),d.set(_,q,B)}f[T-2]=A;break}case 4:{if(m[c]<=0&&(m[c]=m[c]<0?-m[c]:0,h))for(let j=0;j<=D;j++)R.set(j,c,-R.get(j,c));for(;c<D&&!(m[c]>=m[c+1]);){let j=m[c];if(m[c]=m[c+1],m[c+1]=j,h&&c<r-1)for(let v=0;v<r;v++)j=R.get(v,c+1),R.set(v,c+1,R.get(v,c)),R.set(v,c,j);if(u&&c<t-1)for(let v=0;v<t;v++)j=d.get(v,c+1),d.set(v,c+1,d.get(v,c)),d.set(v,c,j);c++}T--;break}}}if(g){let c=R;R=d,d=c}this.m=t,this.n=r,this.s=m,this.U=d,this.V=R}solve(s){let e=s,t=this.threshold,r=this.s.length,o=k.zeros(r,r);for(let w=0;w<r;w++)Math.abs(this.s[w])<=t?o.set(w,w,0):o.set(w,w,1/this.s[w]);let i=this.U,l=this.rightSingularVectors,u=l.mmul(o),h=l.rows,g=i.rows,a=k.zeros(h,g);for(let w=0;w<h;w++)for(let p=0;p<g;p++){let m=0;for(let d=0;d<r;d++)m+=u.get(w,d)*i.get(p,d);a.set(w,p,m)}return a.mmul(e)}solveForDiagonal(s){return this.solve(k.diag(s))}inverse(){let s=this.V,e=this.threshold,t=s.rows,r=s.columns,o=new k(t,this.s.length);for(let g=0;g<t;g++)for(let a=0;a<r;a++)Math.abs(this.s[a])>e&&o.set(g,a,s.get(g,a)/this.s[a]);let i=this.U,l=i.rows,u=i.columns,h=new k(t,l);for(let g=0;g<t;g++)for(let a=0;a<l;a++){let w=0;for(let p=0;p<u;p++)w+=o.get(g,p)*i.get(a,p);h.set(g,a,w)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let s=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,t=this.s;for(let r=0,o=t.length;r<o;r++)t[r]>s&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return k.diag(this.s)}}function us(n,s=!1){return n=Q.checkMatrix(n),s?new ct(n).inverse():Zt(n,k.eye(n.rows))}function Zt(n,s,e=!1){return n=Q.checkMatrix(n),s=Q.checkMatrix(s),e?new ct(n).solve(s):n.isSquare()?new jt(n).solve(s):new xt(n).solve(s)}function vt(n){if(n=k.checkMatrix(n),n.isSquare()){if(n.columns===0)return 1;let s,e,t,r;if(n.columns===2)return s=n.get(0,0),e=n.get(0,1),t=n.get(1,0),r=n.get(1,1),s*r-e*t;if(n.columns===3){let o,i,l;return o=new bt(n,[1,2],[1,2]),i=new bt(n,[1,2],[0,2]),l=new bt(n,[1,2],[0,1]),s=n.get(0,0),e=n.get(0,1),t=n.get(0,2),s*vt(o)-e*vt(i)+t*vt(l)}else return new jt(n).determinant}else throw Error("determinant can only be calculated for a square matrix")}function hs(n,s){let e=[];for(let t=0;t<n;t++)t!==s&&e.push(t);return e}function as(n,s,e,t=1e-9,r=1e-9){if(n>r)return new Array(s.rows+1).fill(0);{let o=s.addRow(e,[0]);for(let i=0;i<o.rows;i++)Math.abs(o.get(i,0))<t&&o.set(i,0,0);return o.to1DArray()}}function fs(n,s={}){const{thresholdValue:e=1e-9,thresholdError:t=1e-9}=s;n=k.checkMatrix(n);let r=n.rows,o=new k(r,r);for(let i=0;i<r;i++){let l=k.columnVector(n.getRow(i)),u=n.subMatrixRow(hs(r,i)).transpose(),g=new ct(u).solve(l),a=k.sub(l,u.mmul(g)).abs().max();o.setRow(i,as(a,g,i,e,t))}return o}function cs(n,s=Number.EPSILON){if(n=k.checkMatrix(n),n.isEmpty())return n.transpose();let e=new ct(n,{autoTranspose:!0}),t=e.leftSingularVectors,r=e.rightSingularVectors,o=e.diagonal;for(let i=0;i<o.length;i++)Math.abs(o[i])>s?o[i]=1/o[i]:o[i]=0;return r.mmul(k.diag(o).mmul(t.transpose()))}function gs(n,s=n,e={}){n=new k(n);let t=!1;if(typeof s=="object"&&!k.isMatrix(s)&&!G.isAnyArray(s)?(e=s,s=n,t=!0):s=new k(s),n.rows!==s.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:r=!0}=e;r&&(n=n.center("column"),t||(s=s.center("column")));const o=n.transpose().mmul(s);for(let i=0;i<o.rows;i++)for(let l=0;l<o.columns;l++)o.set(i,l,o.get(i,l)*(1/(n.rows-1)));return o}function ms(n,s=n,e={}){n=new k(n);let t=!1;if(typeof s=="object"&&!k.isMatrix(s)&&!G.isAnyArray(s)?(e=s,s=n,t=!0):s=new k(s),n.rows!==s.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:r=!0,scale:o=!0}=e;r&&(n.center("column"),t||s.center("column")),o&&(n.scale("column"),t||s.scale("column"));const i=n.standardDeviation("column",{unbiased:!0}),l=t?i:s.standardDeviation("column",{unbiased:!0}),u=n.transpose().mmul(s);for(let h=0;h<u.rows;h++)for(let g=0;g<u.columns;g++)u.set(h,g,u.get(h,g)*(1/(i[h]*l[g]))*(1/(n.rows-1)));return u}class At{constructor(s,e={}){const{assumeSymmetric:t=!1}=e;if(s=Q.checkMatrix(s),!s.isSquare())throw new Error("Matrix is not a square matrix");if(s.isEmpty())throw new Error("Matrix must be non-empty");let r=s.columns,o=new k(r,r),i=new Float64Array(r),l=new Float64Array(r),u=s,h,g,a=!1;if(t?a=!0:a=s.isSymmetric(),a){for(h=0;h<r;h++)for(g=0;g<r;g++)o.set(h,g,u.get(h,g));ws(r,l,i,o),ps(r,l,i,o)}else{let w=new k(r,r),p=new Float64Array(r);for(g=0;g<r;g++)for(h=0;h<r;h++)w.set(h,g,u.get(h,g));ds(r,w,p,o),ys(r,l,i,o,w)}this.n=r,this.e=l,this.d=i,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let s=this.n,e=this.e,t=this.d,r=new k(s,s),o,i;for(o=0;o<s;o++){for(i=0;i<s;i++)r.set(o,i,0);r.set(o,o,t[o]),e[o]>0?r.set(o,o+1,e[o]):e[o]<0&&r.set(o,o-1,e[o])}return r}}function ws(n,s,e,t){let r,o,i,l,u,h,g,a;for(u=0;u<n;u++)e[u]=t.get(n-1,u);for(l=n-1;l>0;l--){for(a=0,i=0,h=0;h<l;h++)a=a+Math.abs(e[h]);if(a===0)for(s[l]=e[l-1],u=0;u<l;u++)e[u]=t.get(l-1,u),t.set(l,u,0),t.set(u,l,0);else{for(h=0;h<l;h++)e[h]/=a,i+=e[h]*e[h];for(r=e[l-1],o=Math.sqrt(i),r>0&&(o=-o),s[l]=a*o,i=i-r*o,e[l-1]=r-o,u=0;u<l;u++)s[u]=0;for(u=0;u<l;u++){for(r=e[u],t.set(u,l,r),o=s[u]+t.get(u,u)*r,h=u+1;h<=l-1;h++)o+=t.get(h,u)*e[h],s[h]+=t.get(h,u)*r;s[u]=o}for(r=0,u=0;u<l;u++)s[u]/=i,r+=s[u]*e[u];for(g=r/(i+i),u=0;u<l;u++)s[u]-=g*e[u];for(u=0;u<l;u++){for(r=e[u],o=s[u],h=u;h<=l-1;h++)t.set(h,u,t.get(h,u)-(r*s[h]+o*e[h]));e[u]=t.get(l-1,u),t.set(l,u,0)}}e[l]=i}for(l=0;l<n-1;l++){if(t.set(n-1,l,t.get(l,l)),t.set(l,l,1),i=e[l+1],i!==0){for(h=0;h<=l;h++)e[h]=t.get(h,l+1)/i;for(u=0;u<=l;u++){for(o=0,h=0;h<=l;h++)o+=t.get(h,l+1)*t.get(h,u);for(h=0;h<=l;h++)t.set(h,u,t.get(h,u)-o*e[h])}}for(h=0;h<=l;h++)t.set(h,l+1,0)}for(u=0;u<n;u++)e[u]=t.get(n-1,u),t.set(n-1,u,0);t.set(n-1,n-1,1),s[0]=0}function ps(n,s,e,t){let r,o,i,l,u,h,g,a,w,p,m,d,R,f,S,y;for(i=1;i<n;i++)s[i-1]=s[i];s[n-1]=0;let M=0,E=0,I=Number.EPSILON;for(h=0;h<n;h++){for(E=Math.max(E,Math.abs(e[h])+Math.abs(s[h])),g=h;g<n&&!(Math.abs(s[g])<=I*E);)g++;if(g>h)do{for(r=e[h],a=(e[h+1]-r)/(2*s[h]),w=et(a,1),a<0&&(w=-w),e[h]=s[h]/(a+w),e[h+1]=s[h]*(a+w),p=e[h+1],o=r-e[h],i=h+2;i<n;i++)e[i]-=o;for(M=M+o,a=e[g],m=1,d=m,R=m,f=s[h+1],S=0,y=0,i=g-1;i>=h;i--)for(R=d,d=m,y=S,r=m*s[i],o=m*a,w=et(a,s[i]),s[i+1]=S*w,S=s[i]/w,m=a/w,a=m*e[i]-S*r,e[i+1]=o+S*(m*r+S*e[i]),u=0;u<n;u++)o=t.get(u,i+1),t.set(u,i+1,S*t.get(u,i)+m*o),t.set(u,i,m*t.get(u,i)-S*o);a=-S*y*R*f*s[h]/p,s[h]=S*a,e[h]=m*a}while(Math.abs(s[h])>I*E);e[h]=e[h]+M,s[h]=0}for(i=0;i<n-1;i++){for(u=i,a=e[i],l=i+1;l<n;l++)e[l]<a&&(u=l,a=e[l]);if(u!==i)for(e[u]=e[i],e[i]=a,l=0;l<n;l++)a=t.get(l,i),t.set(l,i,t.get(l,u)),t.set(l,u,a)}}function ds(n,s,e,t){let r=0,o=n-1,i,l,u,h,g,a,w;for(a=r+1;a<=o-1;a++){for(w=0,h=a;h<=o;h++)w=w+Math.abs(s.get(h,a-1));if(w!==0){for(u=0,h=o;h>=a;h--)e[h]=s.get(h,a-1)/w,u+=e[h]*e[h];for(l=Math.sqrt(u),e[a]>0&&(l=-l),u=u-e[a]*l,e[a]=e[a]-l,g=a;g<n;g++){for(i=0,h=o;h>=a;h--)i+=e[h]*s.get(h,g);for(i=i/u,h=a;h<=o;h++)s.set(h,g,s.get(h,g)-i*e[h])}for(h=0;h<=o;h++){for(i=0,g=o;g>=a;g--)i+=e[g]*s.get(h,g);for(i=i/u,g=a;g<=o;g++)s.set(h,g,s.get(h,g)-i*e[g])}e[a]=w*e[a],s.set(a,a-1,w*l)}}for(h=0;h<n;h++)for(g=0;g<n;g++)t.set(h,g,h===g?1:0);for(a=o-1;a>=r+1;a--)if(s.get(a,a-1)!==0){for(h=a+1;h<=o;h++)e[h]=s.get(h,a-1);for(g=a;g<=o;g++){for(l=0,h=a;h<=o;h++)l+=e[h]*t.get(h,g);for(l=l/e[a]/s.get(a,a-1),h=a;h<=o;h++)t.set(h,g,t.get(h,g)+l*e[h])}}}function ys(n,s,e,t,r){let o=n-1,i=0,l=n-1,u=Number.EPSILON,h=0,g=0,a=0,w=0,p=0,m=0,d=0,R=0,f,S,y,M,E,I,T,D,F,c,b,j,v,x,V;for(f=0;f<n;f++)for((f<i||f>l)&&(e[f]=r.get(f,f),s[f]=0),S=Math.max(f-1,0);S<n;S++)g=g+Math.abs(r.get(f,S));for(;o>=i;){for(M=o;M>i&&(m=Math.abs(r.get(M-1,M-1))+Math.abs(r.get(M,M)),m===0&&(m=g),!(Math.abs(r.get(M,M-1))<u*m));)M--;if(M===o)r.set(o,o,r.get(o,o)+h),e[o]=r.get(o,o),s[o]=0,o--,R=0;else if(M===o-1){if(T=r.get(o,o-1)*r.get(o-1,o),a=(r.get(o-1,o-1)-r.get(o,o))/2,w=a*a+T,d=Math.sqrt(Math.abs(w)),r.set(o,o,r.get(o,o)+h),r.set(o-1,o-1,r.get(o-1,o-1)+h),D=r.get(o,o),w>=0){for(d=a>=0?a+d:a-d,e[o-1]=D+d,e[o]=e[o-1],d!==0&&(e[o]=D-T/d),s[o-1]=0,s[o]=0,D=r.get(o,o-1),m=Math.abs(D)+Math.abs(d),a=D/m,w=d/m,p=Math.sqrt(a*a+w*w),a=a/p,w=w/p,S=o-1;S<n;S++)d=r.get(o-1,S),r.set(o-1,S,w*d+a*r.get(o,S)),r.set(o,S,w*r.get(o,S)-a*d);for(f=0;f<=o;f++)d=r.get(f,o-1),r.set(f,o-1,w*d+a*r.get(f,o)),r.set(f,o,w*r.get(f,o)-a*d);for(f=i;f<=l;f++)d=t.get(f,o-1),t.set(f,o-1,w*d+a*t.get(f,o)),t.set(f,o,w*t.get(f,o)-a*d)}else e[o-1]=D+a,e[o]=D+a,s[o-1]=d,s[o]=-d;o=o-2,R=0}else{if(D=r.get(o,o),F=0,T=0,M<o&&(F=r.get(o-1,o-1),T=r.get(o,o-1)*r.get(o-1,o)),R===10){for(h+=D,f=i;f<=o;f++)r.set(f,f,r.get(f,f)-D);m=Math.abs(r.get(o,o-1))+Math.abs(r.get(o-1,o-2)),D=F=.75*m,T=-.4375*m*m}if(R===30&&(m=(F-D)/2,m=m*m+T,m>0)){for(m=Math.sqrt(m),F<D&&(m=-m),m=D-T/((F-D)/2+m),f=i;f<=o;f++)r.set(f,f,r.get(f,f)-m);h+=m,D=F=T=.964}for(R=R+1,E=o-2;E>=M&&(d=r.get(E,E),p=D-d,m=F-d,a=(p*m-T)/r.get(E+1,E)+r.get(E,E+1),w=r.get(E+1,E+1)-d-p-m,p=r.get(E+2,E+1),m=Math.abs(a)+Math.abs(w)+Math.abs(p),a=a/m,w=w/m,p=p/m,!(E===M||Math.abs(r.get(E,E-1))*(Math.abs(w)+Math.abs(p))<u*(Math.abs(a)*(Math.abs(r.get(E-1,E-1))+Math.abs(d)+Math.abs(r.get(E+1,E+1))))));)E--;for(f=E+2;f<=o;f++)r.set(f,f-2,0),f>E+2&&r.set(f,f-3,0);for(y=E;y<=o-1&&(x=y!==o-1,y!==E&&(a=r.get(y,y-1),w=r.get(y+1,y-1),p=x?r.get(y+2,y-1):0,D=Math.abs(a)+Math.abs(w)+Math.abs(p),D!==0&&(a=a/D,w=w/D,p=p/D)),D!==0);y++)if(m=Math.sqrt(a*a+w*w+p*p),a<0&&(m=-m),m!==0){for(y!==E?r.set(y,y-1,-m*D):M!==E&&r.set(y,y-1,-r.get(y,y-1)),a=a+m,D=a/m,F=w/m,d=p/m,w=w/a,p=p/a,S=y;S<n;S++)a=r.get(y,S)+w*r.get(y+1,S),x&&(a=a+p*r.get(y+2,S),r.set(y+2,S,r.get(y+2,S)-a*d)),r.set(y,S,r.get(y,S)-a*D),r.set(y+1,S,r.get(y+1,S)-a*F);for(f=0;f<=Math.min(o,y+3);f++)a=D*r.get(f,y)+F*r.get(f,y+1),x&&(a=a+d*r.get(f,y+2),r.set(f,y+2,r.get(f,y+2)-a*p)),r.set(f,y,r.get(f,y)-a),r.set(f,y+1,r.get(f,y+1)-a*w);for(f=i;f<=l;f++)a=D*t.get(f,y)+F*t.get(f,y+1),x&&(a=a+d*t.get(f,y+2),t.set(f,y+2,t.get(f,y+2)-a*p)),t.set(f,y,t.get(f,y)-a),t.set(f,y+1,t.get(f,y+1)-a*w)}}}if(g!==0){for(o=n-1;o>=0;o--)if(a=e[o],w=s[o],w===0)for(M=o,r.set(o,o,1),f=o-1;f>=0;f--){for(T=r.get(f,f)-a,p=0,S=M;S<=o;S++)p=p+r.get(f,S)*r.get(S,o);if(s[f]<0)d=T,m=p;else if(M=f,s[f]===0?r.set(f,o,T!==0?-p/T:-p/(u*g)):(D=r.get(f,f+1),F=r.get(f+1,f),w=(e[f]-a)*(e[f]-a)+s[f]*s[f],I=(D*m-d*p)/w,r.set(f,o,I),r.set(f+1,o,Math.abs(D)>Math.abs(d)?(-p-T*I)/D:(-m-F*I)/d)),I=Math.abs(r.get(f,o)),u*I*I>1)for(S=f;S<=o;S++)r.set(S,o,r.get(S,o)/I)}else if(w<0)for(M=o-1,Math.abs(r.get(o,o-1))>Math.abs(r.get(o-1,o))?(r.set(o-1,o-1,w/r.get(o,o-1)),r.set(o-1,o,-(r.get(o,o)-a)/r.get(o,o-1))):(V=yt(0,-r.get(o-1,o),r.get(o-1,o-1)-a,w),r.set(o-1,o-1,V[0]),r.set(o-1,o,V[1])),r.set(o,o-1,0),r.set(o,o,1),f=o-2;f>=0;f--){for(c=0,b=0,S=M;S<=o;S++)c=c+r.get(f,S)*r.get(S,o-1),b=b+r.get(f,S)*r.get(S,o);if(T=r.get(f,f)-a,s[f]<0)d=T,p=c,m=b;else if(M=f,s[f]===0?(V=yt(-c,-b,T,w),r.set(f,o-1,V[0]),r.set(f,o,V[1])):(D=r.get(f,f+1),F=r.get(f+1,f),j=(e[f]-a)*(e[f]-a)+s[f]*s[f]-w*w,v=(e[f]-a)*2*w,j===0&&v===0&&(j=u*g*(Math.abs(T)+Math.abs(w)+Math.abs(D)+Math.abs(F)+Math.abs(d))),V=yt(D*p-d*c+w*b,D*m-d*b-w*c,j,v),r.set(f,o-1,V[0]),r.set(f,o,V[1]),Math.abs(D)>Math.abs(d)+Math.abs(w)?(r.set(f+1,o-1,(-c-T*r.get(f,o-1)+w*r.get(f,o))/D),r.set(f+1,o,(-b-T*r.get(f,o)-w*r.get(f,o-1))/D)):(V=yt(-p-F*r.get(f,o-1),-m-F*r.get(f,o),d,w),r.set(f+1,o-1,V[0]),r.set(f+1,o,V[1]))),I=Math.max(Math.abs(r.get(f,o-1)),Math.abs(r.get(f,o))),u*I*I>1)for(S=f;S<=o;S++)r.set(S,o-1,r.get(S,o-1)/I),r.set(S,o,r.get(S,o)/I)}for(f=0;f<n;f++)if(f<i||f>l)for(S=f;S<n;S++)t.set(f,S,r.get(f,S));for(S=n-1;S>=i;S--)for(f=i;f<=l;f++){for(d=0,y=i;y<=Math.min(S,l);y++)d=d+t.get(f,y)*r.get(y,S);t.set(f,S,d)}}}function yt(n,s,e,t){let r,o;return Math.abs(e)>Math.abs(t)?(r=t/e,o=e+r*t,[(n+r*s)/o,(s-r*n)/o]):(r=e/t,o=t+r*e,[(r*n+s)/o,(r*s-n)/o])}class Ht{constructor(s){if(s=Q.checkMatrix(s),!s.isSymmetric())throw new Error("Matrix is not symmetric");let e=s,t=e.rows,r=new k(t,t),o=!0,i,l,u;for(l=0;l<t;l++){let h=0;for(u=0;u<l;u++){let g=0;for(i=0;i<u;i++)g+=r.get(u,i)*r.get(l,i);g=(e.get(l,u)-g)/r.get(u,u),r.set(l,u,g),h=h+g*g}for(h=e.get(l,l)-h,o&&(o=h>0),r.set(l,l,Math.sqrt(Math.max(h,0))),u=l+1;u<t;u++)r.set(l,u,0)}this.L=r,this.positiveDefinite=o}isPositiveDefinite(){return this.positiveDefinite}solve(s){s=Q.checkMatrix(s);let e=this.L,t=e.rows;if(s.rows!==t)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let r=s.columns,o=s.clone(),i,l,u;for(u=0;u<t;u++)for(l=0;l<r;l++){for(i=0;i<u;i++)o.set(u,l,o.get(u,l)-o.get(i,l)*e.get(u,i));o.set(u,l,o.get(u,l)/e.get(u,u))}for(u=t-1;u>=0;u--)for(l=0;l<r;l++){for(i=u+1;i<t;i++)o.set(u,l,o.get(u,l)-o.get(i,l)*e.get(i,u));o.set(u,l,o.get(u,l)/e.get(u,u))}return o}get lowerTriangularMatrix(){return this.L}}class te{constructor(s,e={}){s=Q.checkMatrix(s);let{Y:t}=e;const{scaleScores:r=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=e;let l;if(t){if(G.isAnyArray(t)&&typeof t[0]=="number"?t=k.columnVector(t):t=Q.checkMatrix(t),t.rows!==s.rows)throw new Error("Y should have the same number of rows as X");l=t.getColumnVector(0)}else l=s.getColumnVector(0);let u=1,h,g,a,w;for(let p=0;p<o&&u>i;p++)a=s.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),a=a.div(a.norm()),h=s.mmul(a).div(a.transpose().mmul(a).get(0,0)),p>0&&(u=h.clone().sub(w).pow(2).sum()),w=h.clone(),t?(g=t.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),g=g.div(g.norm()),l=t.mmul(g).div(g.transpose().mmul(g).get(0,0))):l=h;if(t){let p=s.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));p=p.div(p.norm());let m=s.clone().sub(h.clone().mmul(p.transpose())),d=l.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),R=t.clone().sub(h.clone().mulS(d.get(0,0)).mmul(g.transpose()));this.t=h,this.p=p.transpose(),this.w=a.transpose(),this.q=g,this.u=l,this.s=h.transpose().mmul(h),this.xResidual=m,this.yResidual=R,this.betas=d}else this.w=a.transpose(),this.s=h.transpose().mmul(h).sqrt(),r?this.t=h.clone().div(this.s.get(0,0)):this.t=h,this.xResidual=s.sub(h.mmul(a.transpose()))}}N.AbstractMatrix=C;N.CHO=Ht;N.CholeskyDecomposition=Ht;N.DistanceMatrix=Et;var bs=N.EVD=At;N.EigenvalueDecomposition=At;N.LU=jt;N.LuDecomposition=jt;var ee=N.Matrix=k;N.MatrixColumnSelectionView=ts;N.MatrixColumnView=He;N.MatrixFlipColumnView=es;N.MatrixFlipRowView=ss;N.MatrixRowSelectionView=os;N.MatrixRowView=rs;N.MatrixSelectionView=bt;N.MatrixSubView=ns;var vs=N.MatrixTransposeView=is,Ss=N.NIPALS=te;N.Nipals=te;N.QR=xt;N.QrDecomposition=xt;var Ms=N.SVD=ct;N.SingularValueDecomposition=ct;N.SymmetricMatrix=lt;N.WrapperMatrix1D=Kt;N.WrapperMatrix2D=Q;N.correlation=ms;N.covariance=gs;var Wt=N.default=k;N.determinant=vt;N.inverse=us;N.linearDependencies=fs;N.pseudoInverse=cs;N.solve=Zt;N.wrap=ls;const Es=bs,nt=ee,js=vs,ks=Ss,Rs=Ms;Wt.Matrix&&Wt.Matrix;class Lt{constructor(s,e={},t){if(this.U=null,this.S=null,t){this.center=t.center,this.scale=t.scale,this.means=t.means,this.stdevs=t.stdevs,this.U=nt.checkMatrix(t.U),this.S=t.S,this.R=t.R,this.excludedFeatures=t.excludedFeatures||[];return}let r;Array.isArray(s)?r=new nt(s):r=new nt(s);const{isCovarianceMatrix:o=!1,method:i="SVD",nCompNIPALS:l=2,center:u=!0,scale:h=!1,ignoreZeroVariance:g=!1}=e;if(this.center=u,this.scale=h,this.means=null,this.stdevs=null,this.excludedFeatures=[],o){this._computeFromCovarianceMatrix(r);return}switch(this._adjust(r,g),i){case"covarianceMatrix":{const a=new js(r).mmul(r).div(r.rows-1);this._computeFromCovarianceMatrix(a);break}case"NIPALS":{this._computeWithNIPALS(r,l);break}case"SVD":{const a=new Rs(r,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=a.rightSingularVectors;const w=a.diagonal,p=[];for(const m of w)p.push(m*m/(r.rows-1));this.S=p;break}default:throw new Error(`unknown method: ${i}`)}}static load(s){if(typeof s.name!="string")throw new TypeError("model must have a name property");if(s.name!=="PCA")throw new RangeError(`invalid model: ${s.name}`);return new Lt(void 0,void 0,s)}predict(s,e={}){const{nComponents:t=this.U.columns}=e;let r;if(Array.isArray(s)?r=new nt(s):r=new nt(s),this.center&&(r.subRowVector(this.means),this.scale)){for(let i of this.excludedFeatures)r.removeColumn(i);r.divRowVector(this.stdevs)}let o=r.mmul(this.U);return o.subMatrix(0,o.rows-1,0,t-1)}invert(s){s=nt.checkMatrix(s);let e=s.mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let s=0;if(this.S)for(const e of this.S)s+=e;return this.S?this.S.map(e=>e/s):[]}getCumulativeVariance(){let s=this.getExplainedVariance();for(let e=1;e<s.length;e++)s[e]+=s[e-1];return s}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(s=>Math.sqrt(s))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(s,e){if(this.center){const t=s.mean("column"),r=this.scale?s.standardDeviation("column",{mean:t}):null;if(this.means=t,s.subRowVector(t),this.scale){for(let o=0;o<r.length;o++)if(r[o]===0)if(e)s.removeColumn(o),r.splice(o,1),this.excludedFeatures.push(o),o--;else throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${o}`);this.stdevs=r,s.divRowVector(r)}}}_computeFromCovarianceMatrix(s){const e=new Es(s,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(s,e){this.U=new nt(e,s.columns),this.S=[];let t=s;for(let r=0;r<e;r++){let o=new ks(t);this.U.setRow(r,o.w.transpose()),this.S.push(Math.pow(o.s.get(0,0),2)),t=o.xResidual}this.U=this.U.transpose()}}function se(n,s){if(!it(n)||!it(s))throw new TypeError("x and y must be arrays");if(n.length!==s.length)throw new RangeError("x and y arrays must have the same length")}class zt{constructor(){if(new.target===zt)throw new Error("BaseRegression must be subclassed")}predict(s){if(typeof s=="number")return this._predict(s);if(it(s)){const e=[];for(const t of s)e.push(this._predict(t));return e}else throw new TypeError("x must be a number or array")}_predict(s){throw new Error("_predict must be implemented")}train(){}toString(s){return""}toLaTeX(s){return""}score(s,e){se(s,e);const t=s.length,r=new Array(t);for(let p=0;p<t;p++)r[p]=this._predict(s[p]);let o=0,i=0,l=0,u=0,h=0,g=0,a=0;for(let p=0;p<t;p++)o+=r[p],i+=e[p],h+=r[p]*r[p],g+=e[p]*e[p],a+=r[p]*e[p],e[p]!==0&&(l+=(e[p]-r[p])*(e[p]-r[p])/e[p]),u+=(e[p]-r[p])*(e[p]-r[p]);const w=(t*a-o*i)/Math.sqrt((t*h-o*o)*(t*g-i*i));return{r:w,r2:w*w,chi2:l,rmsd:Math.sqrt(u/t)}}}function Ct(n,s){return n<0?(n=0-n,typeof s=="number"?`- ${n.toPrecision(s)}`:`- ${n.toString()}`):typeof s=="number"?n.toPrecision(s):n.toString()}class Ut extends zt{constructor(s,e){if(super(),s===!0){const t=e;this.slope=t.slope,this.intercept=t.intercept,this.coefficients=[t.intercept,t.slope]}else{se(s,e);const t=Ts(s,e);this.slope=t.slope,this.intercept=t.intercept,this.coefficients=[t.intercept,t.slope]}}toJSON(){return{name:"simpleLinearRegression",slope:this.slope,intercept:this.intercept}}_predict(s){return this.slope*s+this.intercept}computeX(s){return(s-this.intercept)/this.slope}toString(s){let e="f(x) = ";if(this.slope!==0){const t=Ct(this.slope,s);if(e+=`${t==="1"?"":`${t} * `}x`,this.intercept!==0){const r=Math.abs(this.intercept),o=r===this.intercept?"+":"-";e+=` ${o} ${Ct(r,s)}`}}else e+=Ct(this.intercept,s);return e}toLaTeX(s){return this.toString(s)}static load(s){if(s.name!=="simpleLinearRegression")throw new TypeError("not a SLR model");return new Ut(!0,s)}}function Ts(n,s){const e=n.length;let t=0,r=0,o=0,i=0;for(let h=0;h<e;h++)t+=n[h],r+=s[h],o+=n[h]*n[h],i+=n[h]*s[h];const u=(e*i-t*r)/(e*o-t*t);return{slope:u,intercept:1/e*r-u*(1/e)*t}}const Ds={name:"LinearRegression",setup(){const n=tt(null),s=tt(["Target","m2","district"]),e=tt([{Target:199e4,m2:104,district:3},{Target:1236e3,m2:134,district:10},{Target:416500,m2:31,district:6},{Target:313500,m2:38,district:10},{Target:15e5,m2:105,district:9},{Target:33e4,m2:30,district:10},{Target:62e4,m2:4,district:6},{Target:259e3,m2:16,district:6},{Target:145e3,m2:15,district:10},{Target:105e4,m2:84,district:7}]),t=tt(`price,m2,district
2990000,162,5
1236000,134,10
540000,53,2
995000,90,3
249000,15,3
300700,65,5
826250,111,6
400000,56,6
205250,35,7
147620,17,4
800000,63,4
415000,52,5
139500,10,3
1668000,161,10
360000,25,4
1182000,98,9
300700,65,5
495000,31,3
85000,7,4
468000,33,8
850000,71,3
350000,35,10
675000,51,6
735000,105,10
250000,21,5
51000,12,9
1236000,134,10
245000,24,5
59900,6,9
740000,80,10
499000,51,10
600000,40,5
540000,65,10
135000,9,7
700000,73,8
489000,47,10
15000,14,19
220000,24,16
545000,38,6
29500,12,18
725000,65,15
230000,26,18
259800,31,12
1600000,118,8
325000,32,14
235000,23,15
286200,34,18
85000,6,15
19000,6,5
238000,24,17
249000,17,17
170000,16,11
999000,95,15
2950000,194,13
1477142,157,11
1150000,98,9
102000,9,16
275000,34,19
1990000,104,3
1236000,134,10
416500,31,6
313500,38,10
1500000,105,9
330000,30,10
620000,4,6
259000,16,6
145000,15,10
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
550000,43,4
180000,14,5
310000,16,6
945000,66,3
2400000,126,7
665600,46,7
225000,13,7
340000,30,5
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1990000,104,3
1236000,134,10
416500,31,6
313500,38,10
1500000,105,9
330000,30,10
620000,4,6
259000,16,6
145000,15,10
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
550000,43,4
180000,14,5
310000,16,6
945000,66,3
2400000,126,7
665600,46,7
225000,13,7
340000,30,5
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1990000,104,3
1236000,134,10
416500,31,6
313500,38,10
1500000,105,9
330000,30,10
620000,4,6
259000,16,6
145000,15,10
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
550000,43,4
180000,14,5
310000,16,6
945000,66,3
2400000,126,7
665600,46,7
225000,13,7
340000,30,5
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1990000,104,3
1236000,134,10
416500,31,6
313500,38,10
1500000,105,9
330000,30,10
620000,4,6
259000,16,6
145000,15,10
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
679000,67,9
450000,40,10
699000,47,7
330000,22,6
2200000,123,7
800000,60,9
1090000,77,6
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
679000,67,9
450000,40,10
699000,47,7
330000,22,6
2200000,123,7
800000,60,9
1090000,77,6
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
679000,67,9
450000,40,10
699000,47,7
330000,22,6
2200000,123,7
800000,60,9
1090000,77,6
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
679000,67,9
450000,40,10
699000,47,7
330000,22,6
2200000,123,7
800000,60,9
1090000,77,6
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9
1990000,104,3
1236000,134,10
416500,31,6
313500,38,10
1500000,105,9
330000,30,10
620000,4,6
259000,16,6
145000,15,10
1050000,84,7
375000,39,10
550000,41,9
1150000,90,5
55000,5,10
550000,43,4
180000,14,5
310000,16,6
945000,66,3
2400000,126,7
665600,46,7
225000,13,7
340000,30,5
450000,35,6
525000,77,10
807000,73,10
325000,23,5
550000,53,3
1450000,135,9
310000,40,10
1300000,139,10
86000,10,9`),r=tt([]),o=tt({}),i=tt("2d_selected"),l=tt(["m2"]),u=tt(null),h={1:"#FF6B6B",2:"#4ECDC4",3:"#45B7D1",4:"#96CEB4",5:"#FFEAA7",6:"#DDA0DD",7:"#98D8C8",8:"#F7DC6F",9:"#BB8FCE",10:"#85C1E9",11:"#F8C471",12:"#82E0AA",13:"#F1948A",14:"#76D7C4",15:"#AED6F1",16:"#A9DFBF",17:"#F9E79F",18:"#D2B4DE",19:"#A3E4D7",20:"#FAD7A0"},g=y=>h[y]||"#808080",a=()=>{const y={};s.value.forEach(M=>{y[M]=0}),e.value.push(y)},w=()=>{if(!t.value){alert("Please paste CSV data into the textarea.");return}const y=p(t.value);if(y.tableData.length===0){alert("No valid data rows could be imported.");return}s.value=y.columns,e.value=y.tableData,s.value.includes("m2")?l.value=["m2"]:s.value.includes("district")?l.value=["district"]:l.value=[],S()},p=y=>{const M=y.trim().split(`
`);if(M.length<2)return alert("Please provide at least a header row and one data row."),{columns:[],tableData:[]};const E=M[0].split(",").map(D=>D.trim().replace(/^"|"$/g,""));let I=[];if(!E.includes("price")||!E.includes("m2")||!E.includes("district"))return alert("CSV must contain 'price', 'm2', and 'district' columns."),{columns:[],tableData:[]};const T=E.map(D=>D==="price"?"Target":D);for(let D=1;D<M.length;D++){const F=M[D].split(",").map(j=>j.trim().replace(/^"|"$/g,""));if(F.length!==E.length){alert(`Row ${D+1} has an incorrect number of values. Skipping row.`);continue}const c={};let b=!0;for(let j=0;j<E.length;j++){const v=T[j],x=parseFloat(F[j]);if(isNaN(x)){alert(`Invalid number in row ${D+1}, column ${E[j]}. Skipping row.`),b=!1;break}c[v]=x}b&&I.push(c)}return{columns:T,tableData:I}},m=(y,M)=>{const E=s.value[y];if(E!=="Target"){if(!M||s.value.filter((I,T)=>I===M&&T!==y).length>0){alert("Column name must be unique and not empty."),s.value[y]=E;return}e.value.forEach(I=>{I.hasOwnProperty(E)&&(I[M]=I[E],delete I[E])}),l.value=l.value.map(I=>I===E?M:I),s.value[y]=M}},d=y=>{if(!y||!y.points||y.points.length===0)return;const M={};let E=!1;i.value==="2d_selected"?y.points[0].x!==void 0&&y.points[0].y!==void 0&&(M[l.value[0]]=y.points[0].x,M.Target=y.points[0].y,s.value.filter(I=>I!==l.value[0]&&I!=="Target").forEach(I=>{M[I]=0}),E=!0):i.value==="3d_selected"?y.points[0].x!==void 0&&y.points[0].y!==void 0&&y.points[0].z!==void 0&&(M[l.value[0]]=y.points[0].x,M[l.value[1]]=y.points[0].y,M.Target=y.points[0].z,s.value.filter(I=>I!==l.value[0]&&I!==l.value[1]&&I!=="Target").forEach(I=>{M[I]=0}),E=!0):alert("Adding points by clicking on the graph is only supported for '2D Selected Columns vs Target' and '3D Selected Columns vs Target' graph types."),E&&e.value.push(M)},R=()=>{if(console.log("Fitting regression with data:",e.value),e.value.length===0){alert("Please add some data to fit the regression.");return}const y=e.value.map(E=>E[l.value[0]]),M=e.value.map(E=>E.Target);if(y.length!==M.length||y.length<2){alert("Not enough data or mismatch in data for regression. Need at least 2 data points for a single feature.");return}try{u.value=new Ut(y,M),console.log("Regression Model Parameters:",u.value.weights),S()}catch(E){alert("Error fitting regression: "+E.message),console.error("Error fitting regression:",E)}},f=y=>{i.value="2d_selected",l.value=[y],S()},S=()=>{r.value=[],o.value={};const y="Target";switch(i.value){case"2d_pca":if(e.value.length===0){alert("Please add some data for PCA calculation.");return}try{const M=e.value.map(F=>s.value.filter(c=>c!==y).map(c=>F[c]));console.log("Feature Data for PCA:",M);const E=new Lt(new nt(M));console.log("PCA object:",E);const I=E.predict(M).to2DArray(),T=I.map(F=>F[0]),D=I.map(F=>F[1]);r.value=[{x:T,y:D,mode:"markers",type:"scatter"}],o.value={title:"2D PCA of Data",xaxis:{title:"Principal Component 1"},yaxis:{title:"Principal Component 2"}}}catch(M){alert("Error performing PCA: "+M.message),console.error("Error performing PCA:",M)}break;case"3d_selected":l.value[0]==="m2"&&l.value[1]==="district"||(l.value=["m2","district"]);{const M=e.value.map(F=>F[l.value[0]]),E=e.value.map(F=>F[l.value[1]]),I=e.value.map(F=>F[y]),T=e.value.map(F=>F.district),D=T.map(F=>g(F));r.value=[{x:M,y:E,z:I,mode:"markers",type:"scatter3d",marker:{color:D,size:8,opacity:.8,line:{color:"rgba(0,0,0,0.3)",width:1}},text:T.map(F=>`District: ${F}`),hovertemplate:"<b>M2:</b> %{x}<br><b>District:</b> %{y}<br><b>Price:</b> %{z}<br>%{text}<extra></extra>"}],o.value={title:"Selected Features vs Target (3D) - Colored by District",scene:{xaxis:{title:"M2"},yaxis:{title:"District"},zaxis:{title:"Price"}}}}break;case"2d_selected":if(!l.value||l.value.length===0||!(s.value.includes(l.value[0])&&l.value[0]!==y))if(s.value.includes("m2"))l.value=["m2"];else if(s.value.includes("district"))l.value=["district"];else{alert("No valid feature columns (m2 or district) available for 2D plot.");return}{const M=e.value.map(T=>T[l.value[0]]),E=e.value.map(T=>T[y]);r.value=[{x:M,y:E,mode:"markers",type:"scatter"}];const I=s.value.filter(T=>T!==y)[0];if(u.value&&l.value[0]===I){const T=Math.min(...M),D=Math.max(...M),F=[T,D],c=F.map(b=>u.value.predict(b));r.value.push({x:F,y:c,mode:"lines",type:"scatter",name:"Regression Line"})}o.value={title:"Selected Feature vs Target",xaxis:{title:l.value[0]},yaxis:{title:"Price"}}}break;case"2d_all":{const M=s.value.filter(E=>E!==y);r.value=M.map(E=>({x:e.value.map(I=>I[E]),y:e.value.map(I=>I[y]),mode:"markers",type:"scatter",name:E})),o.value={title:"All Features vs Target",xaxis:{title:"Feature Value"},yaxis:{title:"Price"}}}break}console.log("Plot Data:",r.value),console.log("Plot Layout:",o.value),$t(()=>{n.value&&Se.newPlot(n.value,r.value,o.value)})};return we(()=>{const y=t.value.trim().split(`
`),M=y[0],E=y.slice(1,11),I=p([M,...E].join(`
`));s.value=I.columns,e.value=I.tableData,s.value.includes("m2")?l.value=["m2"]:s.value.includes("district")?l.value=["district"]:l.value=[],$t(()=>{S(),n.value&&n.value.on("plotly_click",d)})}),pe(()=>{n.value&&n.value.removeAllListeners("plotly_click")}),de(i,()=>{S()}),{plotlyGraph:n,columns:s,tableData:e,csvInput:t,plotData:r,plotLayout:o,selectedGraphType:i,selectedFeatures:l,regressionModel:u,addRow:a,importData:w,updateColumnName:m,fitRegression:R,selectFeatureFor2D:f,updateGraph:S}}},Is={class:"linear-regression-container bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 pb-10"},Fs={class:"graph-display-section bg-white dark:bg-gray-800 shadow-lg rounded-lg flex flex-col items-center justify-center"},Cs={ref:"plotlyGraph",class:"plotly-graph"},Ns={class:"graph-options mb-4 w-full px-4"},qs={key:0,class:"mt-2 flex space-x-2"},Vs={class:"data-input-section bg-white dark:bg-gray-800 shadow-lg rounded-lg"},Ps={class:"mb-4"},xs={class:"data-table w-full border-collapse rounded-lg overflow-hidden shadow-md"},Ls={class:"bg-blue-600 text-white"},zs=["onUpdate:modelValue","onBlur","disabled"],Us=["onUpdate:modelValue"],_s={class:"mt-4 flex space-x-2"};function $s(n,s,e,t,r,o){return rt(),ot("div",Is,[P("div",Fs,[P("div",Cs,null,512),s[12]||(s[12]=P("h2",{class:"text-xl font-semibold mb-4 text-blue-700 dark:text-blue-300"},"Graph Display",-1)),P("div",Ns,[s[11]||(s[11]=P("label",{for:"graph-type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Select Graph Type:",-1)),wt(P("select",{id:"graph-type","onUpdate:modelValue":s[0]||(s[0]=i=>t.selectedGraphType=i),onChange:s[1]||(s[1]=(...i)=>t.updateGraph&&t.updateGraph(...i)),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},s[10]||(s[10]=[P("option",{value:"2d_pca"},"2D PCA",-1),P("option",{value:"3d_selected"},"3D Selected Columns vs Target",-1),P("option",{value:"2d_selected"},"2D Selected Columns vs Target",-1),P("option",{value:"2d_all"},"2D All Columns vs Target",-1)]),544),[[ye,t.selectedGraphType]]),t.selectedGraphType==="2d_selected"?(rt(),ot("div",qs,[P("button",{onClick:s[2]||(s[2]=i=>t.selectFeatureFor2D("m2")),class:Bt([{"bg-blue-700":t.selectedFeatures[0]==="m2","bg-blue-500":t.selectedFeatures[0]!=="m2"},"text-white font-bold py-2 px-4 rounded-md shadow-md"])},"2D Plot: m2",2),P("button",{onClick:s[3]||(s[3]=i=>t.selectFeatureFor2D("district")),class:Bt([{"bg-blue-700":t.selectedFeatures[0]==="district","bg-blue-500":t.selectedFeatures[0]!=="district"},"text-white font-bold py-2 px-4 rounded-md shadow-md"])},"2D Plot: district",2)])):be("",!0)])]),P("div",Vs,[s[14]||(s[14]=P("h2",{class:"text-xl font-semibold mb-4 text-blue-700 dark:text-blue-300"},"Data Input",-1)),P("div",Ps,[s[13]||(s[13]=P("label",{for:"data-input",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Paste CSV Data Here:",-1)),wt(P("textarea",{id:"data-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.csvInput=i),rows:"6",class:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Dt,t.csvInput]]),P("button",{onClick:s[5]||(s[5]=(...i)=>t.importData&&t.importData(...i)),class:"mt-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md shadow-md"},"Import Data")]),P("table",xs,[P("thead",null,[P("tr",Ls,[(rt(!0),ot(It,null,Ft(t.columns,(i,l)=>(rt(),ot("th",{key:i,class:"py-3 px-4 uppercase font-semibold text-sm"},[wt(P("input",{"onUpdate:modelValue":u=>t.columns[l]=u,onBlur:u=>t.updateColumnName(l,u.target.value),onKeyup:s[6]||(s[6]=ve(u=>u.target.blur(),["enter"])),class:"bg-transparent border-none text-white text-center font-semibold uppercase focus:outline-none",disabled:i==="Target"},null,40,zs),[[Dt,t.columns[l]]])]))),128))])]),P("tbody",null,[(rt(!0),ot(It,null,Ft(t.tableData,(i,l)=>(rt(),ot("tr",{key:l,class:"border-b border-gray-200 dark:border-gray-700"},[(rt(!0),ot(It,null,Ft(t.columns,(u,h)=>(rt(),ot("td",{key:h,class:"py-3 px-4"},[wt(P("input",{"onUpdate:modelValue":g=>i[u]=g,type:"number",class:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Us),[[Dt,i[u]]])]))),128))]))),128))])]),P("div",_s,[P("button",{onClick:s[7]||(s[7]=(...i)=>t.addRow&&t.addRow(...i)),class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md shadow-md"},"Add Row"),P("button",{onClick:s[8]||(s[8]=(...i)=>t.fitRegression&&t.fitRegression(...i)),class:"bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-md shadow-md"},"Fit Regression"),P("button",{onClick:s[9]||(s[9]=(...i)=>t.updateGraph&&t.updateGraph(...i)),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md shadow-md"},"Apply Changes to Graph")])])])}const Qs=me(Ds,[["render",$s],["__scopeId","data-v-b491a740"]]);export{Qs as default};
